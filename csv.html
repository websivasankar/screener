<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Enhanced CSV Viewer</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    padding: 20px;
    min-height: 100vh;
}

.container {
    max-width: 1600px;
    margin: 0 auto;
    background: white;
    border-radius: 12px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    overflow: hidden;
}

.header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 30px;
}

.header h1 { font-size: 28px; margin-bottom: 10px; }
.header .stats { font-size: 14px; opacity: 0.9; }

.controls {
    padding: 20px 30px;
    background: #f8f9fa;
    border-bottom: 1px solid #e0e0e0;
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    align-items: center;
}

.search-box {
    flex: 1;
    min-width: 250px;
    position: relative;
}

.search-box input {
    width: 100%;
    padding: 12px 40px 12px 15px;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    font-size: 14px;
    transition: all 0.3s;
}

.search-box input:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.search-icon {
    position: absolute;
    right: 12px;
    top: 50%;
    transform: translateY(-50%);
    color: #999;
}

.btn {
    padding: 12px 20px;
    border: none;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s;
    display: inline-flex;
    align-items: center;
    gap: 8px;
}

.btn-primary {
    background: #667eea;
    color: white;
}

.btn-primary:hover {
    background: #5568d3;
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
}

.btn-secondary {
    background: white;
    color: #667eea;
    border: 2px solid #667eea;
}

.btn-secondary:hover {
    background: #667eea;
    color: white;
}

.table-wrapper {
    overflow-x: auto;
    max-height: calc(100vh - 300px);
}

table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
}

thead {
    position: sticky;
    top: 0;
    z-index: 10;
}

th {
    background: linear-gradient(180deg, #667eea 0%, #5568d3 100%);
    color: white;
    padding: 15px 12px;
    text-align: left;
    font-weight: 600;
    font-size: 13px;
    cursor: pointer;
    user-select: none;
    position: relative;
    white-space: nowrap;
    border-right: 1px solid rgba(255,255,255,0.1);
}

th:hover {
    background: linear-gradient(180deg, #5568d3 0%, #4557c2 100%);
}

th.sorted-asc::after { content: ' ‚ñ≤'; font-size: 10px; }
th.sorted-desc::after { content: ' ‚ñº'; font-size: 10px; }

.filter-input {
    width: 100%;
    margin-top: 8px;
    padding: 6px 8px;
    border: 1px solid rgba(255,255,255,0.3);
    border-radius: 4px;
    background: rgba(255,255,255,0.9);
    font-size: 12px;
}

.filter-input:focus {
    outline: none;
    border-color: white;
    background: white;
}

tbody tr { transition: background 0.2s; }
tbody tr:nth-child(even) { background: #f8f9fa; }
tbody tr:hover { background: #e3f2fd; }

td {
    padding: 12px;
    border-bottom: 1px solid #e0e0e0;
    font-size: 13px;
    color: #333;
}

.numeric {
    text-align: right;
    font-family: 'Courier New', monospace;
}

.positive { color: #10b981; font-weight: 600; }
.negative { color: #ef4444; font-weight: 600; }

.pagination {
    padding: 20px 30px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: #f8f9fa;
    border-top: 1px solid #e0e0e0;
}

.page-info { color: #666; font-size: 14px; }

.page-controls {
    display: flex;
    gap: 10px;
}

.page-btn {
    padding: 8px 16px;
    border: 1px solid #e0e0e0;
    background: white;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    transition: all 0.2s;
}

.page-btn:hover:not(:disabled) {
    background: #667eea;
    color: white;
    border-color: #667eea;
}

.page-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.page-btn.active {
    background: #667eea;
    color: white;
    border-color: #667eea;
}

select.rows-per-page {
    padding: 8px 12px;
    border: 1px solid #e0e0e0;
    border-radius: 6px;
    font-size: 14px;
    cursor: pointer;
}

.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.5);
    z-index: 1000;
    align-items: center;
    justify-content: center;
}

.modal.active { display: flex; }

.modal-content {
    background: white;
    padding: 30px;
    border-radius: 12px;
    max-width: 500px;
    width: 90%;
    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
}

.modal-content h2 {
    margin-bottom: 20px;
    color: #333;
}

.modal-content button { margin-top: 20px; }

.column-selector {
    max-height: 300px;
    overflow-y: auto;
    margin: 20px 0;
}

.column-item {
    padding: 10px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.column-item input[type="checkbox"] { cursor: pointer; }

@media (max-width: 768px) {
    .controls { flex-direction: column; }
    .search-box { width: 100%; }
}
</style>
</head>
<body>

<div class="container">
    <div class="header">
        <div class="stats">
            <span id="total-rows">0</span> total rows | 
            <span id="filtered-rows">0</span> displayed
        </div>
    </div>

    <div class="controls">
        <div class="search-box">
            <input type="text" id="global-search" placeholder="Search across all columns...">
            <span class="search-icon">üîç</span>
        </div>
        
        <button class="btn btn-primary" onclick="clearFilters()">üîÑ Clear Filters</button>
        <button class="btn btn-secondary" onclick="showColumnSelector()">‚öôÔ∏è Columns</button>
        <button class="btn btn-secondary" onclick="exportToCSV()">üíæ Export CSV</button>
        <button class="btn btn-secondary" onclick="exportToJSON()">üìÑ Export JSON</button>
    </div>

    <div class="table-wrapper">
        <table id="data-table">
            <thead id="table-head"></thead>
            <tbody id="table-body"></tbody>
        </table>
    </div>

    <div class="pagination">
        <div class="page-info">
            Showing <span id="showing-start">0</span> to <span id="showing-end">0</span> of <span id="showing-total">0</span> rows
        </div>
        <div class="page-controls">
            <select class="rows-per-page" id="rows-per-page" onchange="changeRowsPerPage()">
                <option value="25">25 per page</option>
                <option value="50" selected>50 per page</option>
                <option value="100">100 per page</option>
                <option value="200">200 per page</option>
                <option value="-1">Show all</option>
            </select>
            <button class="page-btn" onclick="goToPage(currentPage - 1)" id="prev-btn">‚Üê Prev</button>
            <span id="page-numbers"></span>
            <button class="page-btn" onclick="goToPage(currentPage + 1)" id="next-btn">Next ‚Üí</button>
        </div>
    </div>
</div>

<div class="modal" id="column-modal">
    <div class="modal-content">
        <h2>Show/Hide Columns</h2>
        <div class="column-selector" id="column-selector"></div>
        <button class="btn btn-primary" onclick="closeColumnSelector()">Done</button>
    </div>
</div>

<script>
const CSV_TEXT = `CONTRACT_D,OPTION_TYP,STRIKE_PR,CLOSE_PRIC,UNDRLNG_ST,OI_NO_CON,CONTRACT_D_prev,CLOSE_PRIC_prev,UNDRLNG_ST_prev,OI_NO_CON_prev,Range1,Range2,OI_CHANGE,CHG_IN_OI,NOTIONAL_VALUE
OPTIDXNIFTY30-MAR-2026CE20000,CE,20000,5268.95,25178.65,30485.0,OPTIDXNIFTY30-MAR-2026CE20000,5550.0,25482.5,28470.0,30447.600000000002,19909.7,2015.0,7.077625570776255,16.062394075
OPTIDXNIFTY30-MAR-2026PE23150,PE,23150,22.75,25178.65,12090.0,OPTIDXNIFTY30-MAR-2026PE23150,21.55,25482.5,6565.0,25201.4,25155.9,5525.0,84.15841584158416,0.02750475
OPTIDXNIFTY30-MAR-2026PE23650,PE,23650,39.35,25178.65,39130.0,OPTIDXNIFTY30-MAR-2026PE23650,34.2,25482.5,36660.0,25218.0,25139.300000000003,2470.0,6.73758865248227,0.15397655
OPTIDXNIFTY30-MAR-2026PE23750,PE,23750,43.3,25178.65,82420.0,OPTIDXNIFTY30-MAR-2026PE23750,36.65,25482.5,89505.0,25221.95,25135.350000000002,-7085.0,-7.915758896151052,0.35687859999999993
OPTIDXNIFTY30-MAR-2026CE24050,CE,24050,,25178.65,260.0,OPTIDXNIFTY30-MAR-2026CE24050,1745.0,25482.5,260.0,25178.65,25178.65,0.0,0.0,0.0
OPTIDXNIFTY30-MAR-2026CE24100,CE,24100,1396.25,25178.65,3185.0,OPTIDXNIFTY30-MAR-2026CE24100,1527.0,25482.5,3120.0,26574.9,23782.4,65.0,2.083333333333333,0.444705625
OPTIDXNIFTY30-MAR-2026CE24400,CE,24400,1031.45,25178.65,11310.0,OPTIDXNIFTY30-MAR-2026CE24400,1293.05,25482.5,11440.0,26210.100000000002,24147.2,-130.0,-1.1363636363636365,1.1665699500000002
OPTIDXNIFTY30-MAR-2026CE24500,CE,24500,939.35,25178.65,348010.0,OPTIDXNIFTY30-MAR-2026CE24500,1197.9,25482.5,344240.0,26118.0,24239.300000000003,3770.0,1.095166163141994,32.69031935
OPTIDXNIFTY30-MAR-2026PE24500,PE,24500,115.3,25178.65,3408340.0,OPTIDXNIFTY30-MAR-2026PE24500,83.45,25482.5,3123315.0,25293.95,25063.350000000002,285025.0,9.125720588541341,39.2981602
OPTIDXNIFTY30-MAR-2026PE24550,PE,24550,122.6,25178.65,38415.0,OPTIDXNIFTY30-MAR-2026PE24550,88.7,25482.5,29900.0,25301.25,25056.050000000003,8515.0,28.47826086956522,0.4709678999999999
OPTIDXNIFTY30-MAR-2026CE24850,CE,24850,661.45,25178.65,2470.0,OPTIDXNIFTY30-MAR-2026CE24850,878.25,25482.5,1430.0,25840.100000000002,24517.2,1040.0,72.72727272727273,0.16337815000000003
OPTIDXNIFTY30-MAR-2026CE25300,CE,25300,372.55,25178.65,579345.0,OPTIDXNIFTY30-MAR-2026CE25300,556.45,25482.5,119990.0,25551.2,24806.100000000002,459355.0,382.8277356446371,21.583497975
OPTIDXNIFTY30-MAR-2026PE25600,PE,25600,491.35,25178.65,1089595.0,OPTIDXNIFTY30-MAR-2026PE25600,339.3,25482.5,1094015.0,25670.0,24687.300000000003,-4420.0,-0.4040163983126374,53.53725032500001
OPTIDXNIFTY30-MAR-2026PE25850,PE,25850,650.2,25178.65,53755.0,OPTIDXNIFTY30-MAR-2026PE25850,464.0,25482.5,43615.0,25828.850000000002,24528.45,10140.0,23.248882265275707,3.4951501
OPTIDXNIFTY30-MAR-2026CE26000,CE,26000,100.4,25178.65,6333600.0,OPTIDXNIFTY30-MAR-2026CE26000,181.25,25482.5,5643820.0,25279.050000000003,25078.25,689780.0,12.221863914866173,63.589344
OPTIDXNIFTY30-MAR-2026PE26400,PE,26400,1085.45,25178.65,109915.0,OPTIDXNIFTY30-MAR-2026PE26400,836.25,25482.5,124865.0,26264.100000000002,24093.2,-14950.0,-11.972930765226444,11.930723675000001
OPTIDXNIFTY30-MAR-2026PE27300,PE,27300,,25178.65,11960.0,OPTIDXNIFTY30-MAR-2026PE27300,1684.95,25482.5,11895.0,25178.65,25178.65,65.0,0.546448087431694,0.0
OPTIDXNIFTY30-MAR-2026PE23200,PE,23200,23.55,25178.65,188760.0,OPTIDXNIFTY30-MAR-2026PE23200,22.75,25482.5,111540.0,25202.2,25155.100000000002,77220.0,69.23076923076923,0.4445298
OPTIDXNIFTY30-MAR-2026CE23250,CE,23250,,25178.65,130.0,OPTIDXNIFTY30-MAR-2026CE23250,,25482.5,130.0,25178.65,25178.65,0.0,0.0,0.0
OPTIDXNIFTY30-MAR-2026CE23450,CE,23450,,25178.65,845.0,OPTIDXNIFTY30-MAR-2026CE23450,,25482.5,195.0,25178.65,25178.65,650.0,333.33333333333337,0.0
OPTIDXNIFTY30-MAR-2026CE23700,CE,23700,1760.0,25178.65,2405.0,OPTIDXNIFTY30-MAR-2026CE23700,,25482.5,2145.0,26938.65,23418.65,260.0,12.121212121212121,0.42328
OPTIDXNIFTY30-MAR-2026PE23800,PE,23800,45.15,25178.65,601120.0,OPTIDXNIFTY30-MAR-2026PE23800,38.75,25482.5,574795.0,25223.800000000003,25133.5,26325.0,4.5798937012326135,2.7140568
OPTIDXNIFTY30-MAR-2026PE23850,PE,23850,48.3,25178.65,24115.0,OPTIDXNIFTY30-MAR-2026PE23850,40.6,25482.5,25350.0,25226.95,25130.350000000002,-1235.0,-4.871794871794872,0.11647545
OPTIDXNIFTY30-MAR-2026CE24200,CE,24200,1198.9,25178.65,8190.0,OPTIDXNIFTY30-MAR-2026CE24200,1465.0,25482.5,7670.0,26377.550000000003,23979.75,520.0,6.779661016949152,0.9818991000000001
OPTIDXNIFTY30-MAR-2026CE24600,CE,24600,850.85,25178.65,18655.0,OPTIDXNIFTY30-MAR-2026CE24600,1113.55,25482.5,17485.0,26029.5,24327.800000000003,1170.0,6.691449814126393,1.587260675
OPTIDXNIFTY30-MAR-2026PE25050,PE,25050,243.45,25178.65,75530.0,OPTIDXNIFTY30-MAR-2026PE25050,168.2,25482.5,66235.0,25422.100000000002,24935.2,9295.0,14.033366045142296,1.8387778499999996
OPTIDXNIFTY30-MAR-2026PE25300,PE,25300,338.5,25178.65,1147705.0,OPTIDXNIFTY30-MAR-2026PE25300,231.7,25482.5,859885.0,25517.15,24840.15,287820.0,33.47191775644418,38.84981425
OPTIDXNIFTY30-MAR-2026CE25400,CE,25400,320.75,25178.65,884845.0,OPTIDXNIFTY30-MAR-2026CE25400,492.3,25482.5,395980.0,25499.4,24857.9,488865.0,123.456992777413,28.381403375
OPTIDXNIFTY30-MAR-2026PE26000,PE,26000,761.8,25178.65,4531735.0,OPTIDXNIFTY30-MAR-2026PE26000,547.45,25482.5,4718675.0,25940.45,24416.850000000002,-186940.0,-3.961705351608238,345.22757229999996
OPTIDXNIFTY30-MAR-2026CE26100,CE,26100,80.0,25178.65,821535.0,OPTIDXNIFTY30-MAR-2026CE26100,146.0,25482.5,668525.0,25258.65,25098.65,153010.0,22.887700534759357,6.57228
OPTIDXNIFTY30-MAR-2026CE27150,CE,27150,10.2,25178.65,25740.0,OPTIDXNIFTY30-MAR-2026CE27150,13.35,25482.5,24310.0,25188.850000000002,25168.45,1430.0,5.88235294117647,0.0262548
OPTIDXNIFTY30-MAR-2026PE27200,PE,27200,1846.45,25178.65,27495.0,OPTIDXNIFTY30-MAR-2026PE27200,1567.75,25482.5,24895.0,27025.100000000002,23332.2,2600.0,10.443864229765012,5.076814275
OPTIDXNIFTY30-MAR-2026CE27450,CE,27450,6.85,25178.65,43875.0,OPTIDXNIFTY30-MAR-2026CE27450,8.75,25482.5,22555.0,25185.5,25171.800000000003,21320.0,94.52449567723343,0.030054375
OPTIDXNIFTY30-MAR-2026PE23400,PE,23400,29.35,25178.65,270010.0,OPTIDXNIFTY30-MAR-2026PE23400,27.35,25482.5,265330.0,25208.0,25149.300000000003,4680.0,1.7638412542871142,0.7924793500000001
OPTIDXNIFTY30-MAR-2026PE24100,PE,24100,68.05,25178.65,535210.0,OPTIDXNIFTY30-MAR-2026PE24100,53.75,25482.5,499655.0,25246.7,25110.600000000002,35555.0,7.115909977884741,3.64210405
OPTIDXNIFTY30-MAR-2026CE24700,CE,24700,770.3,25178.65,28405.0,OPTIDXNIFTY30-MAR-2026CE24700,1028.45,25482.5,26975.0,25948.95,24408.350000000002,1430.0,5.301204819277109,2.18803715
OPTIDXNIFTY30-MAR-2026PE25150,PE,25150,280.5,25178.65,105365.0,OPTIDXNIFTY30-MAR-2026PE25150,192.5,25482.5,70330.0,25459.15,24898.15,35035.0,49.81515711645101,2.95548825
OPTIDXNIFTY30-MAR-2026CE25600,CE,25600,224.9,25178.65,1345240.0,OPTIDXNIFTY30-MAR-2026CE25600,369.2,25482.5,1090830.0,25403.550000000003,24953.75,254410.0,23.322607555714455,30.2544476
OPTIDXNIFTY30-MAR-2026PE25700,PE,25700,544.75,25178.65,1236300.0,OPTIDXNIFTY30-MAR-2026PE25700,383.7,25482.5,1442545.0,25723.4,24633.9,-206245.0,-14.297300950750236,67.3474425
OPTIDXNIFTY30-MAR-2026CE25850,CE,25850,138.0,25178.65,113750.0,OPTIDXNIFTY30-MAR-2026CE25850,241.65,25482.5,89830.0,25316.65,25040.65,23920.0,26.62807525325615,1.56975
OPTIDXNIFTY30-MAR-2026PE25900,PE,25900,682.85,25178.65,393120.0,OPTIDXNIFTY30-MAR-2026PE25900,484.3,25482.5,450580.0,25861.5,24495.800000000003,-57460.0,-12.752452394691286,26.8441992
OPTIDXNIFTY30-MAR-2026PE26200,PE,26200,914.9,25178.65,370630.0,OPTIDXNIFTY30-MAR-2026PE26200,679.95,25482.5,399555.0,26093.550000000003,24263.75,-28925.0,-7.239303725394501,33.9089387
OPTIDXNIFTY30-MAR-2026CE26300,CE,26300,50.95,25178.65,1501305.0,OPTIDXNIFTY30-MAR-2026CE26300,92.85,25482.5,928850.0,25229.600000000002,25127.7,572455.0,61.63051084674598,7.649148975000002
OPTIDXNIFTY30-MAR-2026CE26450,CE,26450,36.0,25178.65,62400.0,OPTIDXNIFTY30-MAR-2026CE26450,64.0,25482.5,67210.0,25214.65,25142.65,-4810.0,-7.156673114119923,0.22464
OPTIDXNIFTY30-MAR-2026CE26500,CE,26500,32.6,25178.65,3013725.0,OPTIDXNIFTY30-MAR-2026CE26500,56.95,25482.5,3475355.0,25211.25,25146.050000000003,-461630.0,-13.282959582546244,9.8247435
OPTIDXNIFTY30-MAR-2026PE26500,PE,26500,1188.75,25178.65,1203995.0,OPTIDXNIFTY30-MAR-2026PE26500,920.8,25482.5,1264705.0,26367.4,23989.9,-60710.0,-4.800328930462045,143.124905625
OPTIDXNIFTY30-MAR-2026PE26600,PE,26600,1245.65,25178.65,39195.0,OPTIDXNIFTY30-MAR-2026PE26600,1006.4,25482.5,40755.0,26424.300000000003,23933.0,-1560.0,-3.827751196172249,4.882325175000001
OPTIDXNIFTY30-MAR-2026PE26950,PE,26950,,25178.65,1235.0,OPTIDXNIFTY30-MAR-2026PE26950,1347.45,25482.5,1235.0,25178.65,25178.65,0.0,0.0,0.0
OPTIDXNIFTY30-MAR-2026PE27050,PE,27050,,25178.65,1105.0,OPTIDXNIFTY30-MAR-2026PE27050,1416.55,25482.5,1105.0,25178.65,25178.65,0.0,0.0,0.0
OPTIDXNIFTY30-MAR-2026CE27250,CE,27250,9.3,25178.65,38545.0,OPTIDXNIFTY30-MAR-2026CE27250,11.5,25482.5,31395.0,25187.95,25169.350000000002,7150.0,22.77432712215321,0.035846850000000006
OPTIDXNIFTY30-MAR-2026CE27650,CE,27650,6.3,25178.65,16120.0,OPTIDXNIFTY30-MAR-2026CE27650,7.45,25482.5,17810.0,25184.95,25172.350000000002,-1690.0,-9.48905109489051,0.010155599999999999
OPTIDXNIFTY30-MAR-2026CE27700,CE,27700,5.85,25178.65,190580.0,OPTIDXNIFTY30-MAR-2026CE27700,6.6,25482.5,187330.0,25184.5,25172.800000000003,3250.0,1.7349063150589867,0.1114893
OPTIDXNIFTY30-MAR-2026PE27950,PE,27950,,25178.65,455.0,OPTIDXNIFTY30-MAR-2026PE27950,,25482.5,455.0,25178.65,25178.65,0.0,0.0,0.0
OPTIDXNIFTY30-MAR-2026PE23300,PE,23300,26.35,25178.65,154440.0,OPTIDXNIFTY30-MAR-2026PE23300,24.7,25482.5,140530.0,25205.0,25152.300000000003,13910.0,9.898242368177614,0.40694940000000007
OPTIDXNIFTY30-MAR-2026PE23550,PE,23550,35.45,25178.65,10075.0,OPTIDXNIFTY30-MAR-2026PE23550,32.35,25482.5,12090.0,25214.100000000002,25143.2,-2015.0,-16.666666666666664,0.035715875
OPTIDXNIFTY30-MAR-2026CE23800,CE,23800,1570.9,25178.65,1430.0,OPTIDXNIFTY30-MAR-2026CE23800,,25482.5,1560.0,26749.550000000003,23607.75,-130.0,-8.333333333333332,0.2246387
OPTIDXNIFTY30-MAR-2026CE24150,CE,24150,,25178.65,585.0,OPTIDXNIFTY30-MAR-2026CE24150,1511.25,25482.5,585.0,25178.65,25178.65,0.0,0.0,0.0
OPTIDXNIFTY30-MAR-2026PE24300,PE,24300,88.85,25178.65,403975.0,OPTIDXNIFTY30-MAR-2026PE24300,65.9,25482.5,307710.0,25267.5,25089.800000000003,96265.0,31.284326151246304,3.589317875
OPTIDXNIFTY30-MAR-2026CE24350,CE,24350,,25178.65,910.0,OPTIDXNIFTY30-MAR-2026CE24350,1327.65,25482.5,910.0,25178.65,25178.65,0.0,0.0,0.0
OPTIDXNIFTY30-MAR-2026CE24450,CE,24450,,25178.65,455.0,OPTIDXNIFTY30-MAR-2026CE24450,1226.2,25482.5,455.0,25178.65,25178.65,0.0,0.0,0.0
OPTIDXNIFTY30-MAR-2026PE25100,PE,25100,259.35,25178.65,740415.0,OPTIDXNIFTY30-MAR-2026PE25100,179.75,25482.5,679640.0,25438.0,24919.300000000003,60775.0,8.942234123947973,19.202663025
OPTIDXNIFTY30-MAR-2026CE25200,CE,25200,429.15,25178.65,336180.0,OPTIDXNIFTY30-MAR-2026CE25200,630.85,25482.5,216515.0,25607.800000000003,24749.5,119665.0,55.26868808165716,14.4271647
OPTIDXNIFTY30-MAR-2026PE25200,PE,25200,295.75,25178.65,1463605.0,OPTIDXNIFTY30-MAR-2026PE25200,202.8,25482.5,946075.0,25474.4,24882.9,517530.0,54.70285125386465,43.286117875
OPTIDXNIFTY30-MAR-2026CE25550,CE,25550,245.75,25178.65,100880.0,OPTIDXNIFTY30-MAR-2026CE25550,398.6,25482.5,70720.0,25424.4,24932.9,30160.0,42.64705882352941,2.479126
OPTIDXNIFTY30-MAR-2026CE25700,CE,25700,187.05,25178.65,1313975.0,OPTIDXNIFTY30-MAR-2026CE25700,314.25,25482.5,1402700.0,25365.7,24991.600000000002,-88725.0,-6.325301204819277,24.577902375
OPTIDXNIFTY30-MAR-2026CE26350,CE,26350,45.9,25178.65,101465.0,OPTIDXNIFTY30-MAR-2026CE26350,82.35,25482.5,101530.0,25224.550000000003,25132.75,-65.0,-0.06402048655569782,0.46572435
OPTIDXNIFTY30-MAR-2026CE26550,CE,26550,29.2,25178.65,78130.0,OPTIDXNIFTY30-MAR-2026CE26550,49.9,25482.5,73710.0,25207.850000000002,25149.45,4420.0,5.996472663139329,0.2281396
OPTIDXNIFTY30-MAR-2026PE26700,PE,26700,1363.8,25178.65,48555.0,OPTIDXNIFTY30-MAR-2026PE26700,1096.75,25482.5,49530.0,26542.45,23814.850000000002,-975.0,-1.968503937007874,6.6219309
OPTIDXNIFTY30-MAR-2026CE26800,CE,26800,17.8,25178.65,670345.0,OPTIDXNIFTY30-MAR-2026CE26800,27.0,25482.5,753545.0,25196.45,25160.850000000002,-83200.0,-11.04114551884758,1.1932141
OPTIDXNIFTY30-MAR-2026PE27000,PE,27000,1661.15,25178.65,1887860.0,OPTIDXNIFTY30-MAR-2026PE27000,1375.95,25482.5,1903850.0,26839.800000000003,23517.5,-15990.0,-0.8398770911573915,313.6018639
OPTIDXNIFTY30-MAR-2026CE27200,CE,27200,10.35,25178.65,813410.0,OPTIDXNIFTY30-MAR-2026CE27200,12.95,25482.5,704015.0,25189.0,25168.300000000003,109395.0,15.538731419074878,0.84187935
OPTIDXNIFTY30-MAR-2026PE27350,PE,27350,,25178.65,455.0,OPTIDXNIFTY30-MAR-2026PE27350,1706.1,25482.5,455.0,25178.65,25178.65,0.0,0.0,0.0
OPTIDXNIFTY30-MAR-2026PE27700,PE,27700,2340.8,25178.65,9685.0,OPTIDXNIFTY30-MAR-2026PE27700,2055.55,25482.5,9555.0,27519.45,22837.850000000002,130.0,1.3605442176870748,2.2670648
OPTIDXNIFTY30-MAR-2026CE27800,CE,27800,5.5,25178.65,95615.0,OPTIDXNIFTY30-MAR-2026CE27800,6.05,25482.5,98085.0,25184.15,25173.15,-2470.0,-2.5182239893969514,0.05258825
OPTIDXNIFTY30-MAR-2026PE30000,PE,30000,4640.5,25178.65,546585.0,OPTIDXNIFTY30-MAR-2026PE30000,4338.25,25482.5,548470.0,29819.15,20538.15,-1885.0,-0.34368333728371653,253.64276925
OPTIDXNIFTY30-MAR-2026PE21000,PE,21000,7.8,25178.65,1000870.0,OPTIDXNIFTY30-MAR-2026PE21000,7.5,25482.5,994760.0,25186.45,25170.850000000002,6110.0,0.6142185049660219,0.7806786
OPTIDXNIFTY30-MAR-2026PE24200,PE,24200,76.95,25178.65,727285.0,OPTIDXNIFTY30-MAR-2026PE24200,59.2,25482.5,591500.0,25255.600000000002,25101.7,135785.0,22.956043956043956,5.596458075
OPTIDXNIFTY30-MAR-2026CE24650,CE,24650,894.7,25178.65,780.0,OPTIDXNIFTY30-MAR-2026CE24650,1045.0,25482.5,1300.0,26073.350000000002,24283.95,-520.0,-40.0,0.06978660000000002
OPTIDXNIFTY30-MAR-2026CE24800,CE,24800,698.9,25178.65,78065.0,OPTIDXNIFTY30-MAR-2026CE24800,943.65,25482.5,33605.0,25877.550000000003,24479.75,44460.0,132.3017408123791,5.45596285
OPTIDXNIFTY30-MAR-2026PE24850,PE,24850,187.1,25178.65,52130.0,OPTIDXNIFTY30-MAR-2026PE24850,128.95,25482.5,41145.0,25365.75,24991.550000000003,10985.0,26.698262243285942,0.9753522999999998
OPTIDXNIFTY30-MAR-2026PE24900,PE,24900,198.55,25178.65,544830.0,OPTIDXNIFTY30-MAR-2026PE24900,138.0,25482.5,533000.0,25377.2,24980.100000000002,11830.0,2.219512195121951,10.81759965
OPTIDXNIFTY30-MAR-2026PE27600,PE,27600,2214.15,25178.65,3575.0,OPTIDXNIFTY30-MAR-2026PE27600,,25482.5,3575.0,27392.800000000003,22964.5,0.0,0.0,0.791558625
OPTIDXNIFTY30-MAR-2026PE19000,PE,19000,4.2,25178.65,377910.0,OPTIDXNIFTY30-MAR-2026PE19000,4.35,25482.5,390650.0,25182.850000000002,25174.45,-12740.0,-3.2612312811980035,0.1587222
OPTIDXNIFTY30-MAR-2026PE23350,PE,23350,28.2,25178.65,19305.0,OPTIDXNIFTY30-MAR-2026PE23350,25.4,25482.5,16510.0,25206.850000000002,25150.45,2795.0,16.92913385826772,0.0544401
OPTIDXNIFTY30-MAR-2026CE23500,CE,23500,1868.7,25178.65,275470.0,OPTIDXNIFTY30-MAR-2026CE23500,2146.3,25482.5,280020.0,27047.350000000002,23309.95,-4550.0,-1.6248839368616528,51.47707890000001
OPTIDXNIFTY30-MAR-2026PE23500,PE,23500,32.45,25178.65,1329315.0,OPTIDXNIFTY30-MAR-2026PE23500,29.15,25482.5,1233700.0,25211.100000000002,25146.2,95615.0,7.750263435194942,4.313627175000001
OPTIDXNIFTY30-MAR-2026PE24350,PE,24350,93.45,25178.65,47320.0,OPTIDXNIFTY30-MAR-2026PE24350,69.1,25482.5,25675.0,25272.100000000002,25085.2,21645.0,84.30379746835443,0.4422054
OPTIDXNIFTY30-MAR-2026CE24900,CE,24900,630.4,25178.65,37115.0,OPTIDXNIFTY30-MAR-2026CE24900,864.35,25482.5,17355.0,25809.050000000003,24548.25,19760.0,113.85767790262172,2.3397295999999996
OPTIDXNIFTY30-MAR-2026PE25000,PE,25000,226.2,25178.65,6269770.0,OPTIDXNIFTY30-MAR-2026PE25000,157.3,25482.5,6434935.0,25404.850000000002,24952.45,-165165.0,-2.5666925928544733,141.82219739999996
OPTIDXNIFTY30-MAR-2026CE25150,CE,25150,457.05,25178.65,33670.0,OPTIDXNIFTY30-MAR-2026CE25150,666.8,25482.5,19760.0,25635.7,24721.600000000002,13910.0,70.39473684210526,1.53888735
OPTIDXNIFTY30-MAR-2026PE25350,PE,25350,359.4,25178.65,109980.0,OPTIDXNIFTY30-MAR-2026PE25350,245.35,25482.5,87295.0,25538.050000000003,24819.25,22685.0,25.986597170513775,3.9526811999999993
OPTIDXNIFTY30-MAR-2026CE25500,CE,25500,268.1,25178.65,3394300.0,OPTIDXNIFTY30-MAR-2026CE25500,428.7,25482.5,2462200.0,25446.75,24910.550000000003,932100.0,37.856388595564944,91.00118300000001
OPTIDXNIFTY30-MAR-2026PE25500,PE,25500,433.0,25178.65,3423680.0,OPTIDXNIFTY30-MAR-2026PE25500,299.4,25482.5,3732495.0,25611.65,24745.65,-308815.0,-8.273688243386797,148.245344
OPTIDXNIFTY30-MAR-2026CE25750,CE,25750,169.3,25178.65,132665.0,OPTIDXNIFTY30-MAR-2026CE25750,288.7,25482.5,120055.0,25347.95,25009.350000000002,12610.0,10.503519220357337,2.24601845
OPTIDXNIFTY30-MAR-2026CE26050,CE,26050,90.2,25178.65,110175.0,OPTIDXNIFTY30-MAR-2026CE26050,162.8,25482.5,114790.0,25268.850000000002,25088.45,-4615.0,-4.020385050962627,0.9937785
OPTIDXNIFTY30-MAR-2026CE26150,CE,26150,72.2,25178.65,77610.0,OPTIDXNIFTY30-MAR-2026CE26150,131.3,25482.5,72215.0,25250.850000000002,25106.45,5395.0,7.470747074707471,0.5603442
OPTIDXNIFTY30-MAR-2026PE26300,PE,26300,1003.25,25178.65,223470.0,OPTIDXNIFTY30-MAR-2026PE26300,756.45,25482.5,226330.0,26181.9,24175.4,-2860.0,-1.263641585295807,22.41962775
OPTIDXNIFTY30-MAR-2026PE27250,PE,27250,,25178.65,455.0,OPTIDXNIFTY30-MAR-2026PE27250,1598.6,25482.5,455.0,25178.65,25178.65,0.0,0.0,0.0
OPTIDXNIFTY30-MAR-2026PE27650,PE,27650,,25178.65,1365.0,OPTIDXNIFTY30-MAR-2026PE27650,,25482.5,1365.0,25178.65,25178.65,0.0,0.0,0.0
OPTIDXNIFTY30-MAR-2026CE28000,CE,28000,4.55,25178.65,1720680.0,OPTIDXNIFTY30-MAR-2026CE28000,5.4,25482.5,1816555.0,25183.2,25174.100000000002,-95875.0,-5.2778473539199195,0.7829093999999999
OPTIDXNIFTY30-MAR-2026PE28050,PE,28050,2567.3,25178.65,195.0,OPTIDXNIFTY30-MAR-2026PE28050,,25482.5,260.0,27745.95,22611.350000000002,-65.0,-25.0,0.050062350000000005
OPTIDXNIFTY30-MAR-2026CE23200,CE,23200,2100.0,25178.65,390.0,OPTIDXNIFTY30-MAR-2026CE23200,2430.0,25482.5,390.0,27278.65,23078.65,0.0,0.0,0.0819
OPTIDXNIFTY30-MAR-2026PE23250,PE,23250,25.55,25178.65,20930.0,OPTIDXNIFTY30-MAR-2026PE23250,23.9,25482.5,20930.0,25204.2,25153.100000000002,0.0,0.0,0.05347615
OPTIDXNIFTY30-MAR-2026PE24000,PE,24000,59.55,25178.65,4563260.0,OPTIDXNIFTY30-MAR-2026PE24000,48.05,25482.5,4482465.0,25238.2,25119.100000000002,80795.0,1.8024680616580384,27.1742133
OPTIDXNIFTY30-MAR-2026CE24300,CE,24300,1135.0,25178.65,7410.0,OPTIDXNIFTY30-MAR-2026CE24300,1385.75,25482.5,7995.0,26313.65,24043.65,-585.0,-7.317073170731707,0.841035
OPTIDXNIFTY30-MAR-2026CE30000,CE,30000,2.7,25178.65,774930.0,OPTIDXNIFTY30-MAR-2026CE30000,3.05,25482.5,768950.0,25181.350000000002,25175.95,5980.0,0.7776838546069315,0.2092311
OPTIDXNIFTY30-MAR-2026PE28100,PE,28100,,25178.65,9035.0,OPTIDXNIFTY30-MAR-2026PE28100,2442.05,25482.5,9035.0,25178.65,25178.65,0.0,0.0,0.0
OPTIDXNIFTY30-MAR-2026CE28100,CE,28100,4.3,25178.65,126230.0,OPTIDXNIFTY30-MAR-2026CE28100,5.5,25482.5,76050.0,25182.95,25174.350000000002,50180.0,65.98290598290598,0.0542789
OPTIDXNIFTY30-MAR-2026PE27800,PE,27800,2417.1,25178.65,2015.0,OPTIDXNIFTY30-MAR-2026PE27800,,25482.5,2080.0,27595.75,22761.550000000003,-65.0,-3.125,0.4870456499999999
OPTIDXNIFTY30-MAR-2026PE27150,PE,27150,,25178.65,2730.0,OPTIDXNIFTY30-MAR-2026PE27150,1365.0,25482.5,2730.0,25178.65,25178.65,0.0,0.0,0.0
OPTIDXNIFTY30-MAR-2026CE26650,CE,26650,23.9,25178.65,51025.0,OPTIDXNIFTY30-MAR-2026CE26650,39.05,25482.5,54470.0,25202.550000000003,25154.75,-3445.0,-6.324582338902148,0.12194975
OPTIDXNIFTY30-MAR-2026CE25650,CE,25650,206.1,25178.65,128375.0,OPTIDXNIFTY30-MAR-2026CE25650,341.0,25482.5,79105.0,25384.75,24972.550000000003,49270.0,62.28430566967954,2.64580875
OPTIDXNIFTY30-MAR-2026CE25100,CE,25100,489.65,25178.65,83785.0,OPTIDXNIFTY30-MAR-2026CE25100,704.65,25482.5,55640.0,25668.300000000003,24689.0,28145.0,50.584112149532714,4.102532525
OPTIDXNIFTY30-MAR-2026CE25050,CE,25050,522.25,25178.65,10920.0,OPTIDXNIFTY30-MAR-2026CE25050,748.0,25482.5,3510.0,25700.9,24656.4,7410.0,211.11111111111111,0.570297
OPTIDXNIFTY30-MAR-2026PE31000,PE,31000,5627.55,25178.65,202215.0,OPTIDXNIFTY30-MAR-2026PE31000,5360.0,25482.5,202865.0,30806.2,19551.100000000002,-650.0,-0.32041012495994875,113.797502325
OPTIDXNIFTY30-MAR-2026PE29000,PE,29000,3656.3,25178.65,449800.0,OPTIDXNIFTY30-MAR-2026PE29000,3347.2,25482.5,449865.0,28834.95,21522.350000000002,-65.0,-0.014448779078167894,164.460374
OPTIDXNIFTY30-MAR-2026CE27300,CE,27300,8.65,25178.65,471965.0,OPTIDXNIFTY30-MAR-2026CE27300,10.7,25482.5,499655.0,25187.300000000003,25170.0,-27690.0,-5.541823858462339,0.408249725
OPTIDXNIFTY30-MAR-2026CE26950,CE,26950,13.9,25178.65,64545.0,OPTIDXNIFTY30-MAR-2026CE26950,20.2,25482.5,49465.0,25192.550000000003,25164.75,15080.0,30.486202365308806,0.08971755
OPTIDXNIFTY30-MAR-2026PE26900,PE,26900,,25178.65,6760.0,OPTIDXNIFTY30-MAR-2026PE26900,1314.7,25482.5,6760.0,25178.65,25178.65,0.0,0.0,0.0
OPTIDXNIFTY30-MAR-2026CE26750,CE,26750,19.3,25178.65,88855.0,OPTIDXNIFTY30-MAR-2026CE26750,30.4,25482.5,69680.0,25197.95,25159.350000000002,19175.0,27.51865671641791,0.17149015000000004
OPTIDXNIFTY30-MAR-2026PE26150,PE,26150,908.95,25178.65,27820.0,OPTIDXNIFTY30-MAR-2026PE26150,647.6,25482.5,28925.0,26087.600000000002,24269.7,-1105.0,-3.8202247191011236,2.5286989
OPTIDXNIFTY30-MAR-2026CE25950,CE,25950,111.9,25178.65,117455.0,OPTIDXNIFTY30-MAR-2026CE25950,199.15,25482.5,115310.0,25290.550000000003,25066.75,2145.0,1.8602029312288615,1.3143214500000002
OPTIDXNIFTY30-MAR-2026PE25800,PE,25800,614.6,25178.65,1512745.0,OPTIDXNIFTY30-MAR-2026PE25800,434.75,25482.5,1669460.0,25793.25,24564.050000000003,-156715.0,-9.387167107927114,92.9733077
OPTIDXNIFTY30-MAR-2026PE25450,PE,25450,408.0,25178.65,257335.0,OPTIDXNIFTY30-MAR-2026PE25450,280.45,25482.5,297050.0,25586.65,24770.65,-39715.0,-13.369803063457331,10.499268
OPTIDXNIFTY30-MAR-2026CE25450,CE,25450,292.25,25178.65,85670.0,OPTIDXNIFTY30-MAR-2026CE25450,459.8,25482.5,61685.0,25470.9,24886.4,23985.0,38.883034773445736,2.50370575
OPTIDXNIFTY30-MAR-2026PE24250,PE,24250,83.1,25178.65,33215.0,OPTIDXNIFTY30-MAR-2026PE24250,61.9,25482.5,27950.0,25261.75,25095.550000000003,5265.0,18.83720930232558,0.27601665
OPTIDXNIFTY30-MAR-2026CE23950,CE,23950,,25178.65,195.0,OPTIDXNIFTY30-MAR-2026CE23950,,25482.5,195.0,25178.65,25178.65,0.0,0.0,0.0
OPTIDXNIFTY30-MAR-2026PE23900,PE,23900,50.65,25178.65,381030.0,OPTIDXNIFTY30-MAR-2026PE23900,43.55,25482.5,359840.0,25229.300000000003,25128.0,21190.0,5.888728323699422,1.92991695
OPTIDXNIFTY30-MAR-2026CE23850,CE,23850,,25178.65,130.0,OPTIDXNIFTY30-MAR-2026CE23850,,25482.5,130.0,25178.65,25178.65,0.0,0.0,0.0
OPTIDXNIFTY30-MAR-2026CE23600,CE,23600,1732.3,25178.65,1105.0,OPTIDXNIFTY30-MAR-2026CE23600,,25482.5,650.0,26910.95,23446.350000000002,455.0,70.0,0.19141915
OPTIDXNIFTY30-MAR-2026CE23550,CE,23550,,25178.65,260.0,OPTIDXNIFTY30-MAR-2026CE23550,,25482.5,260.0,25178.65,25178.65,0.0,0.0,0.0
OPTIDXNIFTY30-MAR-2026CE21000,CE,21000,4274.0,25178.65,376545.0,OPTIDXNIFTY30-MAR-2026CE21000,4602.7,25482.5,376415.0,29452.65,20904.65,130.0,0.03453634950785702,160.935333
OPTIDXNIFTY30-MAR-2026PE20000,PE,20000,6.05,25178.65,668525.0,OPTIDXNIFTY30-MAR-2026PE20000,6.0,25482.5,702455.0,25184.7,25172.600000000002,-33930.0,-4.830202646432868,0.404457625
OPTIDXNIFTY30-MAR-2026CE23000,CE,23000,2339.1,25178.65,819780.0,OPTIDXNIFTY30-MAR-2026CE23000,2617.3,25482.5,822900.0,27517.75,22839.550000000003,-3120.0,-0.37914691943127965,191.7547398
OPTIDXNIFTY30-MAR-2026CE29000,CE,29000,3.0,25178.65,866710.0,OPTIDXNIFTY30-MAR-2026CE29000,3.8,25482.5,770510.0,25181.65,25175.65,96200.0,12.485237050784544,0.260013
OPTIDXNIFTY30-MAR-2026CE27950,CE,27950,4.8,25178.65,4875.0,OPTIDXNIFTY30-MAR-2026CE27950,5.45,25482.5,11050.0,25183.45,25173.850000000002,-6175.0,-55.88235294117647,0.00234
OPTIDXNIFTY30-MAR-2026PE27900,PE,27900,2496.35,25178.65,3250.0,OPTIDXNIFTY30-MAR-2026PE27900,,25482.5,3250.0,27675.0,22682.300000000003,0.0,0.0,0.81131375
OPTIDXNIFTY30-MAR-2026CE27900,CE,27900,5.25,25178.65,39455.0,OPTIDXNIFTY30-MAR-2026CE27900,5.8,25482.5,30160.0,25183.9,25173.4,9295.0,30.81896551724138,0.020713875
OPTIDXNIFTY30-MAR-2026CE27550,CE,27550,6.6,25178.65,57720.0,OPTIDXNIFTY30-MAR-2026CE27550,8.45,25482.5,53040.0,25185.25,25172.050000000003,4680.0,8.823529411764707,0.038095199999999996
OPTIDXNIFTY30-MAR-2026CE27500,CE,27500,6.85,25178.65,1193140.0,OPTIDXNIFTY30-MAR-2026CE27500,7.9,25482.5,1280110.0,25185.5,25171.800000000003,-86970.0,-6.7939473951457305,0.8173008999999999
OPTIDXNIFTY30-MAR-2026PE27400,PE,27400,2076.15,25178.65,7410.0,OPTIDXNIFTY30-MAR-2026PE27400,1780.55,25482.5,7540.0,27254.800000000003,23102.5,-130.0,-1.7241379310344827,1.53842715
OPTIDXNIFTY30-MAR-2026CE27400,CE,27400,7.4,25178.65,299390.0,OPTIDXNIFTY30-MAR-2026CE27400,8.9,25482.5,304785.0,25186.050000000003,25171.25,-5395.0,-1.7701002345915973,0.2215486
OPTIDXNIFTY30-MAR-2026CE27000,CE,27000,13.35,25178.65,4032470.0,OPTIDXNIFTY30-MAR-2026CE27000,18.45,25482.5,4064775.0,25192.0,25165.300000000003,-32305.0,-0.7947549372351483,5.38334745
OPTIDXNIFTY30-MAR-2026PE26850,PE,26850,,25178.65,845.0,OPTIDXNIFTY30-MAR-2026PE26850,1253.1,25482.5,780.0,25178.65,25178.65,65.0,8.333333333333332,0.0
OPTIDXNIFTY30-MAR-2026PE26750,PE,26750,1325.0,25178.65,2015.0,OPTIDXNIFTY30-MAR-2026PE26750,1153.95,25482.5,2080.0,26503.65,23853.65,-65.0,-3.125,0.2669875
OPTIDXNIFTY30-MAR-2026CE26700,CE,26700,21.4,25178.65,696280.0,OPTIDXNIFTY30-MAR-2026CE26700,34.3,25482.5,686920.0,25200.050000000003,25157.25,9360.0,1.3626040878122634,1.4900392
OPTIDXNIFTY30-MAR-2026PE26650,PE,26650,,25178.65,2405.0,OPTIDXNIFTY30-MAR-2026PE26650,890.0,25482.5,2405.0,25178.65,25178.65,0.0,0.0,0.0
OPTIDXNIFTY30-MAR-2026CE26600,CE,26600,26.1,25178.65,484510.0,OPTIDXNIFTY30-MAR-2026CE26600,43.85,25482.5,630955.0,25204.75,25152.550000000003,-146445.0,-23.210054599773358,1.2645711000000002
OPTIDXNIFTY30-MAR-2026CE26400,CE,26400,40.0,25178.65,830505.0,OPTIDXNIFTY30-MAR-2026CE26400,72.55,25482.5,877305.0,25218.65,25138.65,-46800.0,-5.334518781951545,3.32202
OPTIDXNIFTY30-MAR-2026PE25650,PE,25650,517.8,25178.65,83200.0,OPTIDXNIFTY30-MAR-2026PE25650,361.95,25482.5,79365.0,25696.45,24660.850000000002,3835.0,4.832104832104831,4.308096
OPTIDXNIFTY30-MAR-2026PE25550,PE,25550,463.7,25178.65,94315.0,OPTIDXNIFTY30-MAR-2026PE25550,319.9,25482.5,93600.0,25642.350000000002,24714.95,715.0,0.7638888888888888,4.37338655
OPTIDXNIFTY30-MAR-2026CE24950,CE,24950,596.2,25178.65,4355.0,OPTIDXNIFTY30-MAR-2026CE24950,805.05,25482.5,1820.0,25774.850000000002,24582.45,2535.0,139.28571428571428,0.2596451
OPTIDXNIFTY30-MAR-2026CE24750,CE,24750,811.6,25178.65,2665.0,OPTIDXNIFTY30-MAR-2026CE24750,985.6,25482.5,2145.0,25990.25,24367.050000000003,520.0,24.242424242424242,0.2162914
OPTIDXNIFTY30-MAR-2026PE24150,PE,24150,71.6,25178.65,31265.0,OPTIDXNIFTY30-MAR-2026PE24150,55.5,25482.5,26390.0,25250.25,25107.050000000003,4875.0,18.472906403940886,0.2238574
OPTIDXNIFTY30-MAR-2026PE23700,PE,23700,41.35,25178.65,420615.0,OPTIDXNIFTY30-MAR-2026PE23700,35.65,25482.5,415935.0,25220.0,25137.300000000003,4680.0,1.1251758087201125,1.7392430250000004
OPTIDXNIFTY30-MAR-2026PE23450,PE,23450,31.85,25178.65,7475.0,OPTIDXNIFTY30-MAR-2026PE23450,28.3,25482.5,10140.0,25210.5,25146.800000000003,-2665.0,-26.282051282051285,0.023807875
OPTIDXNIFTY30-MAR-2026CE23350,CE,23350,,25178.65,130.0,OPTIDXNIFTY30-MAR-2026CE23350,,25482.5,130.0,25178.65,25178.65,0.0,0.0,0.0
OPTIDXNIFTY30-MAR-2026PE23600,PE,23600,36.7,25178.65,348790.0,OPTIDXNIFTY30-MAR-2026PE23600,31.9,25482.5,330915.0,25215.350000000002,25141.95,17875.0,5.401689255549008,1.2800593
OPTIDXNIFTY30-MAR-2026CE23900,CE,23900,1580.0,25178.65,4940.0,OPTIDXNIFTY30-MAR-2026CE23900,,25482.5,4810.0,26758.65,23598.65,130.0,2.7027027027027026,0.78052
OPTIDXNIFTY30-MAR-2026CE24000,CE,24000,1391.3,25178.65,1000220.0,OPTIDXNIFTY30-MAR-2026CE24000,1661.6,25482.5,1019265.0,26569.95,23787.350000000002,-19045.0,-1.868503284229322,139.1606086
OPTIDXNIFTY30-MAR-2026CE24250,CE,24250,,25178.65,650.0,OPTIDXNIFTY30-MAR-2026CE24250,1419.6,25482.5,650.0,25178.65,25178.65,0.0,0.0,0.0
OPTIDXNIFTY30-MAR-2026PE24400,PE,24400,100.9,25178.65,496730.0,OPTIDXNIFTY30-MAR-2026PE24400,74.7,25482.5,464750.0,25279.550000000003,25077.75,31980.0,6.881118881118881,5.0120057
OPTIDXNIFTY30-MAR-2026CE24550,CE,24550,,25178.65,1300.0,OPTIDXNIFTY30-MAR-2026CE24550,1153.7,25482.5,1690.0,25178.65,25178.65,-390.0,-23.076923076923077,0.0
OPTIDXNIFTY30-MAR-2026PE24650,PE,24650,142.45,25178.65,51090.0,OPTIDXNIFTY30-MAR-2026PE24650,99.9,25482.5,42510.0,25321.100000000002,25036.2,8580.0,20.18348623853211,0.72777705
OPTIDXNIFTY30-MAR-2026PE24750,PE,24750,163.75,25178.65,62790.0,OPTIDXNIFTY30-MAR-2026PE24750,113.25,25482.5,47840.0,25342.4,25014.9,14950.0,31.25,1.02818625
OPTIDXNIFTY30-MAR-2026CE25250,CE,25250,400.85,25178.65,47970.0,OPTIDXNIFTY30-MAR-2026CE25250,593.65,25482.5,23725.0,25579.5,24777.800000000003,24245.0,102.1917808219178,1.92287745
OPTIDXNIFTY30-MAR-2026PE25750,PE,25750,585.95,25178.65,93665.0,OPTIDXNIFTY30-MAR-2026PE25750,408.2,25482.5,107250.0,25764.600000000002,24592.7,-13585.0,-12.666666666666668,5.4883006750000005
OPTIDXNIFTY30-MAR-2026PE26100,PE,26100,841.4,25178.65,254020.0,OPTIDXNIFTY30-MAR-2026PE26100,610.6,25482.5,260065.0,26020.050000000003,24337.25,-6045.0,-2.324418895276181,21.373242799999996
OPTIDXNIFTY30-MAR-2026CE26250,CE,26250,56.55,25178.65,107120.0,OPTIDXNIFTY30-MAR-2026CE26250,104.55,25482.5,93925.0,25235.2,25122.100000000002,13195.0,14.048442906574394,0.6057636
OPTIDXNIFTY30-MAR-2026CE27050,CE,27050,11.9,25178.65,43550.0,OPTIDXNIFTY30-MAR-2026CE27050,16.15,25482.5,36985.0,25190.550000000003,25166.75,6565.0,17.75043936731107,0.0518245
OPTIDXNIFTY30-MAR-2026PE27750,PE,27750,,25178.65,325.0,OPTIDXNIFTY30-MAR-2026PE27750,,25482.5,325.0,25178.65,25178.65,0.0,0.0,0.0
OPTIDXNIFTY30-MAR-2026CE27850,CE,27850,,25178.65,6695.0,OPTIDXNIFTY30-MAR-2026CE27850,6.0,25482.5,6825.0,25178.65,25178.65,-130.0,-1.9047619047619049,0.0
OPTIDXNIFTY30-MAR-2026CE31000,CE,31000,2.1,25178.65,267605.0,OPTIDXNIFTY30-MAR-2026CE31000,1.95,25482.5,259870.0,25180.75,25176.550000000003,7735.0,2.976488244122061,0.05619705
OPTIDXNIFTY30-MAR-2026PE22000,PE,22000,10.9,25178.65,1410825.0,OPTIDXNIFTY30-MAR-2026PE22000,10.05,25482.5,1459705.0,25189.550000000003,25167.75,-48880.0,-3.3486218105713137,1.53779925
OPTIDXNIFTY30-MAR-2026CE23150,CE,23150,,25178.65,130.0,OPTIDXNIFTY30-MAR-2026CE23150,,25482.5,130.0,25178.65,25178.65,0.0,0.0,0.0
OPTIDXNIFTY30-MAR-2026CE23400,CE,23400,2050.0,25178.65,1560.0,OPTIDXNIFTY30-MAR-2026CE23400,2220.0,25482.5,1430.0,27228.65,23128.65,130.0,9.090909090909092,0.3198
OPTIDXNIFTY30-MAR-2026PE24050,PE,24050,63.4,25178.65,32305.0,OPTIDXNIFTY30-MAR-2026PE24050,50.0,25482.5,27430.0,25242.050000000003,25115.25,4875.0,17.77251184834123,0.2048137
OPTIDXNIFTY30-MAR-2026PE24450,PE,24450,105.65,25178.65,43810.0,OPTIDXNIFTY30-MAR-2026PE24450,79.0,25482.5,32045.0,25284.300000000003,25073.0,11765.0,36.71399594320487,0.46285265
OPTIDXNIFTY30-MAR-2026PE24600,PE,24600,132.55,25178.65,672165.0,OPTIDXNIFTY30-MAR-2026PE24600,94.95,25482.5,579605.0,25311.2,25046.100000000002,92560.0,15.969496467421779,8.909547075
OPTIDXNIFTY30-MAR-2026PE24700,PE,24700,150.0,25178.65,940875.0,OPTIDXNIFTY30-MAR-2026PE24700,107.4,25482.5,514280.0,25328.65,25028.65,426595.0,82.94994944388272,14.113125
OPTIDXNIFTY30-MAR-2026PE24800,PE,24800,173.65,25178.65,848575.0,OPTIDXNIFTY30-MAR-2026PE24800,121.95,25482.5,761475.0,25352.300000000003,25005.0,87100.0,11.438326931284678,14.735504875
OPTIDXNIFTY30-MAR-2026CE25000,CE,25000,558.8,25178.65,1216020.0,OPTIDXNIFTY30-MAR-2026CE25000,782.9,25482.5,1048190.0,25737.45,24619.850000000002,167830.0,16.01141014510728,67.95119759999999
OPTIDXNIFTY30-MAR-2026PE25250,PE,25250,318.25,25178.65,119535.0,OPTIDXNIFTY30-MAR-2026PE25250,218.3,25482.5,88270.0,25496.9,24860.4,31265.0,35.41973490427099,3.804201375
OPTIDXNIFTY30-MAR-2026PE25400,PE,25400,377.85,25178.65,1243385.0,OPTIDXNIFTY30-MAR-2026PE25400,263.35,25482.5,1012115.0,25556.5,24800.800000000003,231270.0,22.850170188170317,46.981302225
OPTIDXNIFTY30-MAR-2026CE25800,CE,25800,152.75,25178.65,1790815.0,OPTIDXNIFTY30-MAR-2026CE25800,266.0,25482.5,1555645.0,25331.4,25025.9,235170.0,15.117202189445536,27.354699125
OPTIDXNIFTY30-MAR-2026CE25900,CE,25900,124.1,25178.65,949715.0,OPTIDXNIFTY30-MAR-2026CE25900,219.65,25482.5,714480.0,25302.75,25054.550000000003,235235.0,32.92394468704513,11.785963149999999
OPTIDXNIFTY30-MAR-2026PE26050,PE,26050,801.25,25178.65,20280.0,OPTIDXNIFTY30-MAR-2026PE26050,581.3,25482.5,24245.0,25979.9,24377.4,-3965.0,-16.353887399463808,1.624935
OPTIDXNIFTY30-MAR-2026CE26200,CE,26200,63.35,25178.65,1153360.0,OPTIDXNIFTY30-MAR-2026CE26200,116.9,25482.5,1116310.0,25242.0,25115.300000000003,37050.0,3.318970536858041,7.306535600000002
OPTIDXNIFTY30-MAR-2026PE26350,PE,26350,964.35,25178.65,13130.0,OPTIDXNIFTY30-MAR-2026PE26350,702.0,25482.5,13260.0,26143.0,24214.300000000003,-130.0,-0.9803921568627451,1.26619155
OPTIDXNIFTY30-MAR-2026PE26550,PE,26550,,25178.65,2145.0,OPTIDXNIFTY30-MAR-2026PE26550,970.6,25482.5,2145.0,25178.65,25178.65,0.0,0.0,0.0
OPTIDXNIFTY30-MAR-2026CE26900,CE,26900,15.4,25178.65,312000.0,OPTIDXNIFTY30-MAR-2026CE26900,21.75,25482.5,309725.0,25194.050000000003,25163.25,2275.0,0.7345225603357817,0.48048
OPTIDXNIFTY30-MAR-2026CE27100,CE,27100,11.1,25178.65,313105.0,OPTIDXNIFTY30-MAR-2026CE27100,14.85,25482.5,353600.0,25189.75,25167.550000000003,-40495.0,-11.45220588235294,0.34754655
OPTIDXNIFTY30-MAR-2026CE27350,CE,27350,7.8,25178.65,31070.0,OPTIDXNIFTY30-MAR-2026CE27350,9.9,25482.5,17745.0,25186.45,25170.850000000002,13325.0,75.0915750915751,0.0242346
OPTIDXNIFTY30-MAR-2026PE27450,PE,27450,1955.1,25178.65,325.0,OPTIDXNIFTY30-MAR-2026PE27450,,25482.5,390.0,27133.75,23223.550000000003,-65.0,-16.666666666666664,0.06354075
OPTIDXNIFTY30-MAR-2026PE27550,PE,27550,,25178.65,520.0,OPTIDXNIFTY30-MAR-2026PE27550,,25482.5,520.0,25178.65,25178.65,0.0,0.0,0.0
OPTIDXNIFTY30-MAR-2026CE27750,CE,27750,5.7,25178.65,11245.0,OPTIDXNIFTY30-MAR-2026CE27750,6.7,25482.5,12025.0,25184.350000000002,25172.95,-780.0,-6.486486486486487,0.00640965
OPTIDXNIFTY30-MAR-2026PE27850,PE,27850,,25178.65,390.0,OPTIDXNIFTY30-MAR-2026PE27850,,25482.5,390.0,25178.65,25178.65,0.0,0.0,0.0
OPTIDXNIFTY30-MAR-2026CE19000,CE,19000,6259.45,25178.65,178035.0,OPTIDXNIFTY30-MAR-2026CE19000,6560.0,25482.5,179985.0,31438.100000000002,18919.2,-1950.0,-1.0834236186348862,111.440118075
OPTIDXNIFTY30-MAR-2026CE22000,CE,22000,3301.35,25178.65,388505.0,OPTIDXNIFTY30-MAR-2026CE22000,3592.95,25482.5,389155.0,28480.0,21877.300000000003,-650.0,-0.1670285618840822,128.259098175
OPTIDXNIFTY30-MAR-2026PE23000,PE,23000,20.8,25178.65,2788500.0,OPTIDXNIFTY30-MAR-2026PE23000,19.55,25482.5,2653365.0,25199.45,25157.850000000002,135135.0,5.092966855295069,5.80008
OPTIDXNIFTY30-MAR-2026CE23100,CE,23100,2250.0,25178.65,2925.0,OPTIDXNIFTY30-MAR-2026CE23100,2613.6,25482.5,3315.0,27428.65,22928.65,-390.0,-11.76470588235294,0.658125
OPTIDXNIFTY30-MAR-2026PE23100,PE,23100,22.1,25178.65,155545.0,OPTIDXNIFTY30-MAR-2026PE23100,20.8,25482.5,126230.0,25200.75,25156.550000000003,29315.0,23.223480947476826,0.34375445
OPTIDXNIFTY30-MAR-2026CE23300,CE,23300,2000.0,25178.65,325.0,OPTIDXNIFTY30-MAR-2026CE23300,,25482.5,325.0,27178.65,23178.65,0.0,0.0,0.065
OPTIDXNIFTY30-MAR-2026CE23650,CE,23650,,25178.65,195.0,OPTIDXNIFTY30-MAR-2026CE23650,,25482.5,195.0,25178.65,25178.65,0.0,0.0,0.0
OPTIDXNIFTY30-MAR-2026CE23750,CE,23750,,25178.65,9360.0,OPTIDXNIFTY30-MAR-2026CE23750,,25482.5,9360.0,25178.65,25178.65,0.0,0.0,0.0
OPTIDXNIFTY30-MAR-2026CE28050,CE,28050,4.65,25178.65,24375.0,OPTIDXNIFTY30-MAR-2026CE28050,5.3,25482.5,6565.0,25183.300000000003,25174.0,17810.0,271.2871287128713,0.011334375
OPTIDXNIFTY30-MAR-2026PE28000,PE,28000,2664.75,25178.65,930735.0,OPTIDXNIFTY30-MAR-2026PE28000,2348.5,25482.5,934245.0,27843.4,22513.9,-3510.0,-0.37570444583594237,248.017609125
OPTIDXNIFTY30-MAR-2026CE27600,CE,27600,6.3,25178.65,133510.0,OPTIDXNIFTY30-MAR-2026CE27600,7.35,25482.5,133900.0,25184.95,25172.350000000002,-390.0,-0.2912621359223301,0.08411129999999999
OPTIDXNIFTY30-MAR-2026PE27500,PE,27500,2162.25,25178.65,436020.0,OPTIDXNIFTY30-MAR-2026PE27500,1863.1,25482.5,432835.0,27340.9,23016.4,3185.0,0.7358462231566302,94.2784245
OPTIDXNIFTY30-MAR-2026PE27100,PE,27100,1781.8,25178.65,3900.0,OPTIDXNIFTY30-MAR-2026PE27100,1499.65,25482.5,3835.0,26960.45,23396.850000000002,65.0,1.694915254237288,0.694902
OPTIDXNIFTY30-MAR-2026CE26850,CE,26850,16.2,25178.65,53950.0,OPTIDXNIFTY30-MAR-2026CE26850,24.3,25482.5,56290.0,25194.850000000002,25162.45,-2340.0,-4.157043879907621,0.087399
OPTIDXNIFTY30-MAR-2026PE26800,PE,26800,1457.5,25178.65,35425.0,OPTIDXNIFTY30-MAR-2026PE26800,1179.35,25482.5,45565.0,26636.15,23721.15,-10140.0,-22.25392296718973,5.16319375
OPTIDXNIFTY30-MAR-2026PE26450,PE,26450,,25178.65,6305.0,OPTIDXNIFTY30-MAR-2026PE26450,,25482.5,6500.0,25178.65,25178.65,-195.0,-3.0,0.0
OPTIDXNIFTY30-MAR-2026PE26250,PE,26250,970.2,25178.65,17875.0,OPTIDXNIFTY30-MAR-2026PE26250,722.0,25482.5,18070.0,26148.850000000002,24208.45,-195.0,-1.079136690647482,1.7342325
OPTIDXNIFTY30-MAR-2026PE25950,PE,25950,729.35,25178.65,19760.0,OPTIDXNIFTY30-MAR-2026PE25950,518.8,25482.5,27430.0,25908.0,24449.300000000003,-7670.0,-27.96208530805687,1.4411956
OPTIDXNIFTY30-MAR-2026CE25350,CE,25350,343.85,25178.65,107770.0,OPTIDXNIFTY30-MAR-2026CE25350,525.25,25482.5,23140.0,25522.5,24834.800000000003,84630.0,365.7303370786517,3.70567145
OPTIDXNIFTY30-MAR-2026PE24950,PE,24950,212.3,25178.65,49270.0,OPTIDXNIFTY30-MAR-2026PE24950,147.3,25482.5,42705.0,25390.95,24966.350000000002,6565.0,15.37290715372907,1.0460021
OPTIDXNIFTY30-MAR-2026PE23950,PE,23950,55.25,25178.65,25350.0,OPTIDXNIFTY30-MAR-2026PE23950,44.4,25482.5,31460.0,25233.9,25123.4,-6110.0,-19.421487603305785,0.14005875
`;

let headers = [];
let originalData = [];
let filteredData = [];
let displayData = [];
let sortColumn = null;
let sortDirection = 'asc';
let currentPage = 1;
let rowsPerPage = 200;
let columnFilters = {};
let hiddenColumns = new Set();

const numericColumns = ['STRIKE_PR', 'CLOSE_PRIC', 'UNDRLNG_ST', 'OI_NO_CON', 'CLOSE_PRIC_prev', 
                        'UNDRLNG_ST_prev', 'OI_NO_CON_prev', 'Range1', 'Range2', 'OI_CHANGE', 
                        'CHG_IN_OI', 'NOTIONAL_VALUE'];

parseCSV(CSV_TEXT);

function parseCSV(text) {
    const rows = text.trim().split("\n").map(r => r.split(","));
    headers = rows[0];
    originalData = rows.slice(1).map(r => {
        let obj = {};
        headers.forEach((h, i) => { obj[h] = r[i] || ''; });
        return obj;
    });
    filteredData = [...originalData];
    displayData = [...originalData];
    updateStats();
    renderTable();
    renderPagination();
}

function renderTable() {
    renderHeaders();
    renderBody();
}

function renderHeaders() {
    let html = '<tr>';
    headers.forEach(h => {
        if (hiddenColumns.has(h)) return;
        const sortClass = sortColumn === h ? `sorted-${sortDirection}` : '';
        html += `<th class="${sortClass}" onclick="sortByColumn('${h}')">
                    <div>${h}</div>
                    <input type="text" class="filter-input" placeholder="Filter..." 
                           onclick="event.stopPropagation()" oninput="filterColumn('${h}', this.value)">
                 </th>`;
    });
    html += '</tr>';
    document.getElementById('table-head').innerHTML = html;
}

function renderBody() {
    const start = (currentPage - 1) * rowsPerPage;
    const end = rowsPerPage === -1 ? displayData.length : start + rowsPerPage;
    const pageData = displayData.slice(start, end);
    
    let html = '';
    pageData.forEach(row => {
        html += '<tr>';
        headers.forEach(h => {
            if (hiddenColumns.has(h)) return;
            const value = row[h];
            const isNumeric = numericColumns.includes(h);
            let className = isNumeric ? 'numeric' : '';
            if (h === 'CHG_IN_OI' || h === 'OI_CHANGE') {
                const num = parseFloat(value);
                if (num > 0) className += ' positive';
                else if (num < 0) className += ' negative';
            }
            html += `<td class="${className}">${formatValue(h, value)}</td>`;
        });
        html += '</tr>';
    });
    
    document.getElementById('table-body').innerHTML = html || '<tr><td colspan="100" style="text-align:center;padding:40px;">No data to display</td></tr>';
    updatePaginationInfo();
}

function formatValue(header, value) {
    if (!value) return '-';
    if (numericColumns.includes(header)) {
        const num = parseFloat(value);
        if (isNaN(num)) return value;
        if (Math.abs(num) >= 1000000) return (num / 1000000).toFixed(2) + 'M';
        else if (Math.abs(num) >= 1000) return (num / 1000).toFixed(2) + 'K';
        else return num.toFixed(2);
    }
    return value;
}

function sortByColumn(column) {
    if (sortColumn === column) {
        sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
    } else {
        sortColumn = column;
        sortDirection = 'asc';
    }
    displayData.sort((a, b) => {
        let aVal = a[column];
        let bVal = b[column];
        if (!aVal) return 1;
        if (!bVal) return -1;
        if (numericColumns.includes(column)) {
            aVal = parseFloat(aVal) || 0;
            bVal = parseFloat(bVal) || 0;
        }
        if (sortDirection === 'asc') {
            return aVal > bVal ? 1 : -1;
        } else {
            return aVal < bVal ? 1 : -1;
        }
    });
    renderTable();
}

function filterColumn(column, value) {
    columnFilters[column] = value.toLowerCase();
    applyFilters();
}

function applyFilters() {
    filteredData = originalData.filter(row => {
        return Object.keys(columnFilters).every(col => {
            const filterValue = columnFilters[col];
            if (!filterValue) return true;
            const cellValue = String(row[col]).toLowerCase();
            return cellValue.includes(filterValue);
        });
    });
    const globalSearch = document.getElementById('global-search').value.toLowerCase();
    if (globalSearch) {
        filteredData = filteredData.filter(row => {
            return headers.some(h => String(row[h]).toLowerCase().includes(globalSearch));
        });
    }
    displayData = [...filteredData];
    currentPage = 1;
    updateStats();
    renderTable();
    renderPagination();
}

function clearFilters() {
    columnFilters = {};
    document.getElementById('global-search').value = '';
    document.querySelectorAll('.filter-input').forEach(input => input.value = '');
    applyFilters();
}

function updateStats() {
    document.getElementById('total-rows').textContent = originalData.length.toLocaleString();
    document.getElementById('filtered-rows').textContent = filteredData.length.toLocaleString();
}

function renderPagination() {
    const totalPages = rowsPerPage === -1 ? 1 : Math.ceil(displayData.length / rowsPerPage);
    document.getElementById('prev-btn').disabled = currentPage === 1;
    document.getElementById('next-btn').disabled = currentPage === totalPages || totalPages === 0;
    let pageNumbers = '';
    const maxButtons = 5;
    let startPage = Math.max(1, currentPage - Math.floor(maxButtons / 2));
    let endPage = Math.min(totalPages, startPage + maxButtons - 1);
    if (endPage - startPage < maxButtons - 1) {
        startPage = Math.max(1, endPage - maxButtons + 1);
    }
    for (let i = startPage; i <= endPage; i++) {
        const activeClass = i === currentPage ? 'active' : '';
        pageNumbers += `<button class="page-btn ${activeClass}" onclick="goToPage(${i})">${i}</button>`;
    }
    document.getElementById('page-numbers').innerHTML = pageNumbers;
}

function updatePaginationInfo() {
    const start = rowsPerPage === -1 ? 1 : (currentPage - 1) * rowsPerPage + 1;
    const end = rowsPerPage === -1 ? displayData.length : Math.min(currentPage * rowsPerPage, displayData.length);
    const total = displayData.length;
    document.getElementById('showing-start').textContent = total === 0 ? 0 : start;
    document.getElementById('showing-end').textContent = end;
    document.getElementById('showing-total').textContent = total;
}

function goToPage(page) {
    const totalPages = rowsPerPage === -1 ? 1 : Math.ceil(displayData.length / rowsPerPage);
    if (page >= 1 && page <= totalPages) {
        currentPage = page;
        renderBody();
        renderPagination();
        document.querySelector('.table-wrapper').scrollTop = 0;
    }
}

function changeRowsPerPage() {
    rowsPerPage = parseInt(document.getElementById('rows-per-page').value);
    currentPage = 1;
    renderBody();
    renderPagination();
}

function showColumnSelector() {
    const modal = document.getElementById('column-modal');
    const selector = document.getElementById('column-selector');
    let html = '';
    headers.forEach(h => {
        const checked = !hiddenColumns.has(h) ? 'checked' : '';
        html += `<div class="column-item">
                    <input type="checkbox" id="col-${h}" ${checked} onchange="toggleColumn('${h}', this.checked)">
                    <label for="col-${h}">${h}</label>
                 </div>`;
    });
    selector.innerHTML = html;
    modal.classList.add('active');
}

function closeColumnSelector() {
    document.getElementById('column-modal').classList.remove('active');
}

function toggleColumn(column, show) {
    if (show) {
        hiddenColumns.delete(column);
    } else {
        hiddenColumns.add(column);
    }
    renderTable();
}

function exportToCSV() {
    let csv = headers.filter(h => !hiddenColumns.has(h)).join(',') + '\n';
    displayData.forEach(row => {
        const values = headers.filter(h => !hiddenColumns.has(h)).map(h => {
            const value = row[h];
            if (value.includes(',') || value.includes('"')) {
                return '"' + value.replace(/"/g, '""') + '"';
            }
            return value;
        });
        csv += values.join(',') + '\n';
    });
    downloadFile(csv, 'export.csv', 'text/csv');
}

function exportToJSON() {
    const json = JSON.stringify(displayData, null, 2);
    downloadFile(json, 'export.json', 'application/json');
}

function downloadFile(content, filename, contentType) {
    const blob = new Blob([content], { type: contentType });
    const url = URL.createObjectURL(blob);
    const link = document.createElement('a');
    link.href = url;
    link.download = filename;
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    URL.revokeObjectURL(url);
}

let searchTimeout;
document.getElementById('global-search').addEventListener('input', function() {
    clearTimeout(searchTimeout);
    searchTimeout = setTimeout(() => { applyFilters(); }, 300);
});

document.getElementById('column-modal').addEventListener('click', function(e) {
    if (e.target === this) closeColumnSelector();
});

document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') closeColumnSelector();
    if ((e.ctrlKey || e.metaKey) && e.key === 'f') {
        e.preventDefault();
        document.getElementById('global-search').focus();
    }
});
</script>
</body>
</html>