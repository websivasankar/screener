<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Enhanced CSV Viewer</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    padding: 20px;
    min-height: 100vh;
}

.container {
    max-width: 1600px;
    margin: 0 auto;
    background: white;
    border-radius: 12px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    overflow: hidden;
}

.header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 30px;
}

.header h1 { font-size: 28px; margin-bottom: 10px; }
.header .stats { font-size: 14px; opacity: 0.9; }

.controls {
    padding: 20px 30px;
    background: #f8f9fa;
    border-bottom: 1px solid #e0e0e0;
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    align-items: center;
}

.search-box {
    flex: 1;
    min-width: 250px;
    position: relative;
}

.search-box input {
    width: 100%;
    padding: 12px 40px 12px 15px;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    font-size: 14px;
    transition: all 0.3s;
}

.search-box input:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.search-icon {
    position: absolute;
    right: 12px;
    top: 50%;
    transform: translateY(-50%);
    color: #999;
}

.btn {
    padding: 12px 20px;
    border: none;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s;
    display: inline-flex;
    align-items: center;
    gap: 8px;
}

.btn-primary {
    background: #667eea;
    color: white;
}

.btn-primary:hover {
    background: #5568d3;
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
}

.btn-secondary {
    background: white;
    color: #667eea;
    border: 2px solid #667eea;
}

.btn-secondary:hover {
    background: #667eea;
    color: white;
}

.table-wrapper {
    overflow-x: auto;
    max-height: calc(100vh - 300px);
}

table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
}

thead {
    position: sticky;
    top: 0;
    z-index: 10;
}

th {
    background: linear-gradient(180deg, #667eea 0%, #5568d3 100%);
    color: white;
    padding: 15px 12px;
    text-align: left;
    font-weight: 600;
    font-size: 13px;
    cursor: pointer;
    user-select: none;
    position: relative;
    white-space: nowrap;
    border-right: 1px solid rgba(255,255,255,0.1);
}

th:hover {
    background: linear-gradient(180deg, #5568d3 0%, #4557c2 100%);
}

th.sorted-asc::after { content: ' ‚ñ≤'; font-size: 10px; }
th.sorted-desc::after { content: ' ‚ñº'; font-size: 10px; }

.filter-input {
    width: 100%;
    margin-top: 8px;
    padding: 6px 8px;
    border: 1px solid rgba(255,255,255,0.3);
    border-radius: 4px;
    background: rgba(255,255,255,0.9);
    font-size: 12px;
}

.filter-input:focus {
    outline: none;
    border-color: white;
    background: white;
}

tbody tr { transition: background 0.2s; }
tbody tr:nth-child(even) { background: #f8f9fa; }
tbody tr:hover { background: #e3f2fd; }

td {
    padding: 12px;
    border-bottom: 1px solid #e0e0e0;
    font-size: 13px;
    color: #333;
}

.numeric {
    text-align: right;
    font-family: 'Courier New', monospace;
}

.positive { color: #10b981; font-weight: 600; }
.negative { color: #ef4444; font-weight: 600; }

.pagination {
    padding: 20px 30px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: #f8f9fa;
    border-top: 1px solid #e0e0e0;
}

.page-info { color: #666; font-size: 14px; }

.page-controls {
    display: flex;
    gap: 10px;
}

.page-btn {
    padding: 8px 16px;
    border: 1px solid #e0e0e0;
    background: white;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    transition: all 0.2s;
}

.page-btn:hover:not(:disabled) {
    background: #667eea;
    color: white;
    border-color: #667eea;
}

.page-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.page-btn.active {
    background: #667eea;
    color: white;
    border-color: #667eea;
}

select.rows-per-page {
    padding: 8px 12px;
    border: 1px solid #e0e0e0;
    border-radius: 6px;
    font-size: 14px;
    cursor: pointer;
}

.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.5);
    z-index: 1000;
    align-items: center;
    justify-content: center;
}

.modal.active { display: flex; }

.modal-content {
    background: white;
    padding: 30px;
    border-radius: 12px;
    max-width: 500px;
    width: 90%;
    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
}

.modal-content h2 {
    margin-bottom: 20px;
    color: #333;
}

.modal-content button { margin-top: 20px; }

.column-selector {
    max-height: 300px;
    overflow-y: auto;
    margin: 20px 0;
}

.column-item {
    padding: 10px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.column-item input[type="checkbox"] { cursor: pointer; }

@media (max-width: 768px) {
    .controls { flex-direction: column; }
    .search-box { width: 100%; }
}
</style>
</head>
<body>

<div class="container">
    <div class="header">
        <div class="stats">
            <span id="total-rows">0</span> total rows | 
            <span id="filtered-rows">0</span> displayed
        </div>
    </div>

    <div class="controls">
        <div class="search-box">
            <input type="text" id="global-search" placeholder="Search across all columns...">
            <span class="search-icon">üîç</span>
        </div>
        
        <button class="btn btn-primary" onclick="clearFilters()">üîÑ Clear Filters</button>
        <button class="btn btn-secondary" onclick="showColumnSelector()">‚öôÔ∏è Columns</button>
        <button class="btn btn-secondary" onclick="exportToCSV()">üíæ Export CSV</button>
        <button class="btn btn-secondary" onclick="exportToJSON()">üìÑ Export JSON</button>
    </div>

    <div class="table-wrapper">
        <table id="data-table">
            <thead id="table-head"></thead>
            <tbody id="table-body"></tbody>
        </table>
    </div>

    <div class="pagination">
        <div class="page-info">
            Showing <span id="showing-start">0</span> to <span id="showing-end">0</span> of <span id="showing-total">0</span> rows
        </div>
        <div class="page-controls">
            <select class="rows-per-page" id="rows-per-page" onchange="changeRowsPerPage()">
                <option value="25">25 per page</option>
                <option value="50" selected>50 per page</option>
                <option value="100">100 per page</option>
                <option value="200">200 per page</option>
                <option value="-1">Show all</option>
            </select>
            <button class="page-btn" onclick="goToPage(currentPage - 1)" id="prev-btn">‚Üê Prev</button>
            <span id="page-numbers"></span>
            <button class="page-btn" onclick="goToPage(currentPage + 1)" id="next-btn">Next ‚Üí</button>
        </div>
    </div>
</div>

<div class="modal" id="column-modal">
    <div class="modal-content">
        <h2>Show/Hide Columns</h2>
        <div class="column-selector" id="column-selector"></div>
        <button class="btn btn-primary" onclick="closeColumnSelector()">Done</button>
    </div>
</div>

<script>
const CSV_TEXT = `CONTRACT_D,OPTION_TYP,STRIKE_PR,CLOSE_PRIC,UNDRLNG_ST,OI_NO_CON,CONTRACT_D_prev,CLOSE_PRIC_prev,UNDRLNG_ST_prev,OI_NO_CON_prev,Range1,Range2,OI_CHANGE,CHG_IN_OI,NOTIONAL_VALUE
OPTIDXNIFTY30-MAR-2026CE30000,CE,30000,3.05,25424.65,774995.0,OPTIDXNIFTY30-MAR-2026CE30000,3.55,25713.0,760760.0,25427.7,25421.600000000002,14235.0,1.871155160628845,0.236373475
OPTIDXNIFTY30-MAR-2026PE28100,PE,28100,2459.9,25424.65,8125.0,OPTIDXNIFTY30-MAR-2026PE28100,2187.7,25713.0,4940.0,27884.550000000003,22964.75,3185.0,64.47368421052632,1.99866875
OPTIDXNIFTY30-MAR-2026CE28100,CE,28100,5.95,25424.65,73840.0,OPTIDXNIFTY30-MAR-2026CE28100,6.65,25713.0,70200.0,25430.600000000002,25418.7,3640.0,5.185185185185185,0.0439348
OPTIDXNIFTY30-MAR-2026PE27800,PE,27800,2215.6,25424.65,2080.0,OPTIDXNIFTY30-MAR-2026PE27800,1907.45,25713.0,845.0,27640.25,23209.050000000003,1235.0,146.15384615384613,0.4608448
OPTIDXNIFTY30-MAR-2026PE27150,PE,27150,1563.75,25424.65,2210.0,OPTIDXNIFTY30-MAR-2026PE27150,1300.0,25713.0,2015.0,26988.4,23860.9,195.0,9.67741935483871,0.34558875
OPTIDXNIFTY30-MAR-2026CE26650,CE,26650,46.8,25424.65,38090.0,OPTIDXNIFTY30-MAR-2026CE26650,74.7,25713.0,36855.0,25471.45,25377.850000000002,1235.0,3.3509700176366843,0.1782612
OPTIDXNIFTY30-MAR-2026CE25650,CE,25650,344.15,25424.65,67470.0,OPTIDXNIFTY30-MAR-2026CE25650,498.75,25713.0,43030.0,25768.800000000003,25080.5,24440.0,56.797583081571,2.3219800499999996
OPTIDXNIFTY30-MAR-2026CE25100,CE,25100,696.55,25424.65,53820.0,OPTIDXNIFTY30-MAR-2026CE25100,907.7,25713.0,50700.0,26121.2,24728.100000000002,3120.0,6.153846153846154,3.748832099999999
OPTIDXNIFTY30-MAR-2026CE25050,CE,25050,718.65,25424.65,3770.0,OPTIDXNIFTY30-MAR-2026CE25050,984.45,25713.0,2470.0,26143.300000000003,24706.0,1300.0,52.63157894736842,0.27093105
OPTIDXNIFTY30-MAR-2026CE24300,CE,24300,1362.45,25424.65,7930.0,OPTIDXNIFTY30-MAR-2026CE24300,1604.0,25713.0,5850.0,26787.100000000002,24062.2,2080.0,35.55555555555556,1.08042285
OPTIDXNIFTY30-MAR-2026PE24000,PE,24000,54.45,25424.65,4450160.0,OPTIDXNIFTY30-MAR-2026PE24000,50.6,25713.0,4340245.0,25479.100000000002,25370.2,109915.0,2.5324607251433964,24.231121200000004
OPTIDXNIFTY30-MAR-2026PE23250,PE,23250,28.15,25424.65,21450.0,OPTIDXNIFTY30-MAR-2026PE23250,28.75,25713.0,8970.0,25452.800000000003,25396.5,12480.0,139.1304347826087,0.06038175
OPTIDXNIFTY30-MAR-2026CE23200,CE,23200,2400.75,25424.65,325.0,OPTIDXNIFTY30-MAR-2026CE23200,2676.0,25713.0,325.0,27825.4,23023.9,0.0,0.0,0.078024375
OPTIDXNIFTY30-MAR-2026PE21000,PE,21000,8.8,25424.65,992940.0,OPTIDXNIFTY30-MAR-2026PE21000,10.15,25713.0,984100.0,25433.45,25415.850000000002,8840.0,0.8982826948480845,0.8737872000000002
OPTIDXNIFTY30-MAR-2026PE24200,PE,24200,67.45,25424.65,552240.0,OPTIDXNIFTY30-MAR-2026PE24200,60.1,25713.0,521430.0,25492.100000000002,25357.2,30810.0,5.908750934928945,3.7248588000000007
OPTIDXNIFTY30-MAR-2026CE24650,CE,24650,1047.0,25424.65,1040.0,OPTIDXNIFTY30-MAR-2026CE24650,1271.35,25713.0,780.0,26471.65,24377.65,260.0,33.33333333333333,0.108888
OPTIDXNIFTY30-MAR-2026CE24800,CE,24800,922.55,25424.65,32760.0,OPTIDXNIFTY30-MAR-2026CE24800,1157.4,25713.0,31005.0,26347.2,24502.100000000002,1755.0,5.660377358490567,3.0222738
OPTIDXNIFTY30-MAR-2026PE24850,PE,24850,145.3,25424.65,36985.0,OPTIDXNIFTY30-MAR-2026PE24850,112.4,25713.0,34320.0,25569.95,25279.350000000002,2665.0,7.765151515151516,0.5373920500000001
OPTIDXNIFTY30-MAR-2026PE24900,PE,24900,156.4,25424.65,459095.0,OPTIDXNIFTY30-MAR-2026PE24900,120.05,25713.0,431600.0,25581.050000000003,25268.25,27495.0,6.370481927710843,7.1802458
OPTIDXNIFTY30-MAR-2026PE27600,PE,27600,2000.0,25424.65,3575.0,OPTIDXNIFTY30-MAR-2026PE27600,1736.0,25713.0,2925.0,27424.65,23424.65,650.0,22.22222222222222,0.715
OPTIDXNIFTY30-MAR-2026CE20000,CE,20000,5544.0,25424.65,28795.0,OPTIDXNIFTY30-MAR-2026CE20000,5794.2,25713.0,29510.0,30968.65,19880.65,-715.0,-2.4229074889867843,15.963948
OPTIDXNIFTY30-MAR-2026PE23150,PE,23150,25.9,25424.65,7670.0,OPTIDXNIFTY30-MAR-2026PE23150,26.6,25713.0,4940.0,25450.550000000003,25398.75,2730.0,55.26315789473685,0.0198653
OPTIDXNIFTY30-MAR-2026PE23650,PE,23650,38.6,25424.65,35750.0,OPTIDXNIFTY30-MAR-2026PE23650,39.35,25713.0,36010.0,25463.25,25386.050000000003,-260.0,-0.7220216606498195,0.137995
OPTIDXNIFTY30-MAR-2026PE23750,PE,23750,43.2,25424.65,85800.0,OPTIDXNIFTY30-MAR-2026PE23750,41.65,25713.0,95550.0,25467.850000000002,25381.45,-9750.0,-10.204081632653061,0.37065600000000004
OPTIDXNIFTY30-MAR-2026CE24050,CE,24050,1575.05,25424.65,195.0,OPTIDXNIFTY30-MAR-2026CE24050,,25713.0,130.0,26999.7,23849.600000000002,65.0,50.0,0.030713475
OPTIDXNIFTY30-MAR-2026CE24100,CE,24100,1539.45,25424.65,2925.0,OPTIDXNIFTY30-MAR-2026CE24100,1780.65,25713.0,2730.0,26964.100000000002,23885.2,195.0,7.142857142857142,0.450289125
OPTIDXNIFTY30-MAR-2026CE24400,CE,24400,1266.15,25424.65,11310.0,OPTIDXNIFTY30-MAR-2026CE24400,1510.5,25713.0,11765.0,26690.800000000003,24158.5,-455.0,-3.867403314917127,1.43201565
OPTIDXNIFTY30-MAR-2026CE24500,CE,24500,1178.45,25424.65,325000.0,OPTIDXNIFTY30-MAR-2026CE24500,1419.6,25713.0,259155.0,26603.100000000002,24246.2,65845.0,25.407574617506896,38.299625
OPTIDXNIFTY30-MAR-2026PE24500,PE,24500,94.75,25424.65,3068650.0,OPTIDXNIFTY30-MAR-2026PE24500,78.65,25713.0,2858050.0,25519.4,25329.9,210600.0,7.3686604503070265,29.07545875
OPTIDXNIFTY30-MAR-2026PE24550,PE,24550,100.8,25424.65,25155.0,OPTIDXNIFTY30-MAR-2026PE24550,82.95,25713.0,24570.0,25525.45,25323.850000000002,585.0,2.380952380952381,0.2535624
OPTIDXNIFTY30-MAR-2026CE24850,CE,24850,874.85,25424.65,1430.0,OPTIDXNIFTY30-MAR-2026CE24850,1113.35,25713.0,1495.0,26299.5,24549.800000000003,-65.0,-4.3478260869565215,0.12510355
OPTIDXNIFTY30-MAR-2026CE25300,CE,25300,555.2,25424.65,145405.0,OPTIDXNIFTY30-MAR-2026CE25300,745.65,25713.0,94965.0,25979.850000000002,24869.45,50440.0,53.11430527036276,8.072885600000001
OPTIDXNIFTY30-MAR-2026PE25600,PE,25600,373.45,25424.65,1035515.0,OPTIDXNIFTY30-MAR-2026PE25600,271.3,25713.0,712400.0,25798.100000000002,25051.2,323115.0,45.355839416058394,38.671307675
OPTIDXNIFTY30-MAR-2026PE25850,PE,25850,499.9,25424.65,43095.0,OPTIDXNIFTY30-MAR-2026PE25850,361.1,25713.0,45370.0,25924.550000000003,24924.75,-2275.0,-5.014326647564469,2.15431905
OPTIDXNIFTY30-MAR-2026CE26000,CE,26000,189.1,25424.65,5892575.0,OPTIDXNIFTY30-MAR-2026CE26000,292.8,25713.0,4880070.0,25613.75,25235.550000000003,1012505.0,20.747755667439197,111.42859325
OPTIDXNIFTY30-MAR-2026PE26400,PE,26400,876.85,25424.65,124865.0,OPTIDXNIFTY30-MAR-2026PE26400,664.0,25713.0,123370.0,26301.5,24547.800000000003,1495.0,1.2118018967334034,10.948787525
OPTIDXNIFTY30-MAR-2026PE27300,PE,27300,1704.15,25424.65,11570.0,OPTIDXNIFTY30-MAR-2026PE27300,1455.35,25713.0,10270.0,27128.800000000003,23720.5,1300.0,12.658227848101266,1.97170155
OPTIDXNIFTY30-MAR-2026PE25200,PE,25200,228.6,25424.65,827840.0,OPTIDXNIFTY30-MAR-2026PE25200,168.6,25713.0,816530.0,25653.25,25196.050000000003,11310.0,1.3851297564082152,18.9244224
OPTIDXNIFTY30-MAR-2026CE25550,CE,25550,397.5,25424.65,60645.0,OPTIDXNIFTY30-MAR-2026CE25550,564.15,25713.0,30810.0,25822.15,25027.15,29835.0,96.83544303797468,2.41063875
OPTIDXNIFTY30-MAR-2026CE25700,CE,25700,316.7,25424.65,1421615.0,OPTIDXNIFTY30-MAR-2026CE25700,464.35,25713.0,812565.0,25741.350000000002,25107.95,609050.0,74.95400367970562,45.02254705
OPTIDXNIFTY30-MAR-2026CE26350,CE,26350,91.6,25424.65,98540.0,OPTIDXNIFTY30-MAR-2026CE26350,148.35,25713.0,83460.0,25516.25,25333.050000000003,15080.0,18.06853582554517,0.9026264
OPTIDXNIFTY30-MAR-2026CE26550,CE,26550,58.65,25424.65,67665.0,OPTIDXNIFTY30-MAR-2026CE26550,94.4,25713.0,69160.0,25483.300000000003,25366.0,-1495.0,-2.161654135338346,0.396855225
OPTIDXNIFTY30-MAR-2026PE26700,PE,26700,1129.6,25424.65,49465.0,OPTIDXNIFTY30-MAR-2026PE26700,894.15,25713.0,73905.0,26554.25,24295.050000000003,-24440.0,-33.06948109058927,5.5875664
OPTIDXNIFTY30-MAR-2026CE26800,CE,26800,33.05,25424.65,674700.0,OPTIDXNIFTY30-MAR-2026CE26800,51.0,25713.0,549120.0,25457.7,25391.600000000002,125580.0,22.869318181818183,2.2298834999999997
OPTIDXNIFTY30-MAR-2026PE27000,PE,27000,1416.6,25424.65,1901250.0,OPTIDXNIFTY30-MAR-2026PE27000,1163.1,25713.0,1721980.0,26841.25,24008.050000000003,179270.0,10.410690019628568,269.331075
OPTIDXNIFTY30-MAR-2026CE27200,CE,27200,15.85,25424.65,545090.0,OPTIDXNIFTY30-MAR-2026CE27200,21.15,25713.0,532220.0,25440.5,25408.800000000003,12870.0,2.418172936003908,0.86396765
OPTIDXNIFTY30-MAR-2026PE27350,PE,27350,1763.65,25424.65,585.0,OPTIDXNIFTY30-MAR-2026PE27350,1482.65,25713.0,520.0,27188.300000000003,23661.0,65.0,12.5,0.103173525
OPTIDXNIFTY30-MAR-2026PE27700,PE,27700,2099.0,25424.65,9620.0,OPTIDXNIFTY30-MAR-2026PE27700,1836.0,25713.0,9620.0,27523.65,23325.65,0.0,0.0,2.019238
OPTIDXNIFTY30-MAR-2026CE27800,CE,27800,7.2,25424.65,79300.0,OPTIDXNIFTY30-MAR-2026CE27800,8.75,25713.0,75985.0,25431.850000000002,25417.45,3315.0,4.362703165098375,0.057096
OPTIDXNIFTY30-MAR-2026PE30000,PE,30000,4373.1,25424.65,548600.0,OPTIDXNIFTY30-MAR-2026PE30000,4107.35,25713.0,544375.0,29797.75,21051.550000000003,4225.0,0.7761194029850746,239.908266
OPTIDXNIFTY30-MAR-2026CE24350,CE,24350,1303.85,25424.65,910.0,OPTIDXNIFTY30-MAR-2026CE24350,1547.35,25713.0,910.0,26728.5,24120.800000000003,0.0,0.0,0.11865034999999997
OPTIDXNIFTY30-MAR-2026PE24300,PE,24300,75.15,25424.65,284505.0,OPTIDXNIFTY30-MAR-2026PE24300,65.4,25713.0,280930.0,25499.800000000003,25349.5,3575.0,1.2725590004627487,2.1380550750000005
OPTIDXNIFTY30-MAR-2026CE24150,CE,24150,1480.05,25424.65,520.0,OPTIDXNIFTY30-MAR-2026CE24150,1757.0,25713.0,455.0,26904.7,23944.600000000002,65.0,14.285714285714285,0.0769626
OPTIDXNIFTY30-MAR-2026CE23800,CE,23800,1969.75,25424.65,1560.0,OPTIDXNIFTY30-MAR-2026CE23800,2053.25,25713.0,1625.0,27394.4,23454.9,-65.0,-4.0,0.307281
OPTIDXNIFTY30-MAR-2026PE23550,PE,23550,35.85,25424.65,11375.0,OPTIDXNIFTY30-MAR-2026PE23550,36.7,25713.0,19370.0,25460.5,25388.800000000003,-7995.0,-41.2751677852349,0.040779375
OPTIDXNIFTY30-MAR-2026PE23300,PE,23300,28.6,25424.65,135395.0,OPTIDXNIFTY30-MAR-2026PE23300,30.75,25713.0,132145.0,25453.25,25396.050000000003,3250.0,2.459419576979833,0.3872297
OPTIDXNIFTY30-MAR-2026CE24450,CE,24450,1192.15,25424.65,390.0,OPTIDXNIFTY30-MAR-2026CE24450,1453.65,25713.0,455.0,26616.800000000003,24232.5,-65.0,-14.285714285714285,0.04649385
OPTIDXNIFTY30-MAR-2026PE25100,PE,25100,202.9,25424.65,651885.0,OPTIDXNIFTY30-MAR-2026PE25100,150.65,25713.0,590135.0,25627.550000000003,25221.75,61750.0,10.463707456768367,13.22674665
OPTIDXNIFTY30-MAR-2026CE25200,CE,25200,623.05,25424.65,219050.0,OPTIDXNIFTY30-MAR-2026CE25200,824.2,25713.0,202345.0,26047.7,24801.600000000002,16705.0,8.255701895277866,13.64791025
OPTIDXNIFTY30-MAR-2026CE26450,CE,26450,73.65,25424.65,49855.0,OPTIDXNIFTY30-MAR-2026CE26450,117.8,25713.0,53430.0,25498.300000000003,25351.0,-3575.0,-6.690997566909976,0.367182075
OPTIDXNIFTY30-MAR-2026CE26500,CE,26500,66.3,25424.65,3066765.0,OPTIDXNIFTY30-MAR-2026CE26500,105.8,25713.0,3272100.0,25490.95,25358.350000000002,-205335.0,-6.275327771156139,20.33265195
OPTIDXNIFTY30-MAR-2026PE26500,PE,26500,966.4,25424.65,1267825.0,OPTIDXNIFTY30-MAR-2026PE26500,734.45,25713.0,944775.0,26391.050000000003,24458.25,323050.0,34.19332645338837,122.522608
OPTIDXNIFTY30-MAR-2026PE26600,PE,26600,1048.3,25424.65,40690.0,OPTIDXNIFTY30-MAR-2026PE26600,812.4,25713.0,37960.0,26472.95,24376.350000000002,2730.0,7.191780821917808,4.2655327
OPTIDXNIFTY30-MAR-2026PE26950,PE,26950,1380.6,25424.65,1235.0,OPTIDXNIFTY30-MAR-2026PE26950,1136.75,25713.0,1300.0,26805.25,24044.050000000003,-65.0,-5.0,0.17050409999999996
OPTIDXNIFTY30-MAR-2026PE27050,PE,27050,1471.65,25424.65,1170.0,OPTIDXNIFTY30-MAR-2026PE27050,1277.9,25713.0,1300.0,26896.300000000003,23953.0,-130.0,-10.0,0.17218305
OPTIDXNIFTY30-MAR-2026CE27250,CE,27250,14.0,25424.65,27235.0,OPTIDXNIFTY30-MAR-2026CE27250,19.25,25713.0,25350.0,25438.65,25410.65,1885.0,7.435897435897436,0.038129
OPTIDXNIFTY30-MAR-2026CE27650,CE,27650,8.85,25424.65,14625.0,OPTIDXNIFTY30-MAR-2026CE27650,10.0,25713.0,15665.0,25433.5,25415.800000000003,-1040.0,-6.639004149377594,0.012943125
OPTIDXNIFTY30-MAR-2026CE27700,CE,27700,7.95,25424.65,185510.0,OPTIDXNIFTY30-MAR-2026CE27700,9.55,25713.0,172575.0,25432.600000000002,25416.7,12935.0,7.495291902071563,0.14748045
OPTIDXNIFTY30-MAR-2026PE27950,PE,27950,2314.65,25424.65,455.0,OPTIDXNIFTY30-MAR-2026PE27950,,25713.0,390.0,27739.300000000003,23110.0,65.0,16.666666666666664,0.105316575
OPTIDXNIFTY30-MAR-2026PE23400,PE,23400,31.35,25424.65,247585.0,OPTIDXNIFTY30-MAR-2026PE23400,32.6,25713.0,243100.0,25456.0,25393.300000000003,4485.0,1.8449197860962565,0.7761789750000001
OPTIDXNIFTY30-MAR-2026PE24100,PE,24100,60.75,25424.65,472485.0,OPTIDXNIFTY30-MAR-2026PE24100,56.25,25713.0,461305.0,25485.4,25363.9,11180.0,2.4235592503874877,2.870346375
OPTIDXNIFTY30-MAR-2026CE24700,CE,24700,1019.05,25424.65,27430.0,OPTIDXNIFTY30-MAR-2026CE24700,1255.1,25713.0,26715.0,26443.7,24405.600000000002,715.0,2.67639902676399,2.79525415
OPTIDXNIFTY30-MAR-2026PE25150,PE,25150,216.8,25424.65,58565.0,OPTIDXNIFTY30-MAR-2026PE25150,158.8,25713.0,47450.0,25641.45,25207.850000000002,11115.0,23.424657534246577,1.2696892000000002
OPTIDXNIFTY30-MAR-2026CE25600,CE,25600,371.2,25424.65,994175.0,OPTIDXNIFTY30-MAR-2026CE25600,529.55,25713.0,438360.0,25795.850000000002,25053.45,555815.0,126.79418742586002,36.903776
OPTIDXNIFTY30-MAR-2026PE25700,PE,25700,419.55,25424.65,1363700.0,OPTIDXNIFTY30-MAR-2026PE25700,304.1,25713.0,1116375.0,25844.2,25005.100000000002,247325.0,22.154294032023287,57.2140335
OPTIDXNIFTY30-MAR-2026CE25850,CE,25850,247.8,25424.65,87555.0,OPTIDXNIFTY30-MAR-2026CE25850,375.6,25713.0,64480.0,25672.45,25176.850000000002,23075.0,35.78629032258064,2.1696129
OPTIDXNIFTY30-MAR-2026PE25900,PE,25900,522.8,25424.65,476515.0,OPTIDXNIFTY30-MAR-2026PE25900,383.9,25713.0,393120.0,25947.45,24901.850000000002,83395.0,21.21362433862434,24.9122042
OPTIDXNIFTY30-MAR-2026PE26200,PE,26200,719.55,25424.65,401310.0,OPTIDXNIFTY30-MAR-2026PE26200,537.15,25713.0,249340.0,26144.2,24705.100000000002,151970.0,60.94890510948905,28.876261049999993
OPTIDXNIFTY30-MAR-2026CE26300,CE,26300,102.0,25424.65,791570.0,OPTIDXNIFTY30-MAR-2026CE26300,164.8,25713.0,781820.0,25526.65,25322.65,9750.0,1.2470901230462255,8.074014
OPTIDXNIFTY30-MAR-2026PE23600,PE,23600,36.85,25424.65,319670.0,OPTIDXNIFTY30-MAR-2026PE23600,37.95,25713.0,317005.0,25461.5,25387.800000000003,2665.0,0.8406807463604674,1.1779839500000002
OPTIDXNIFTY30-MAR-2026CE23900,CE,23900,1720.7,25424.65,4810.0,OPTIDXNIFTY30-MAR-2026CE23900,1975.0,25713.0,4810.0,27145.350000000002,23703.95,0.0,0.0,0.8276567
OPTIDXNIFTY30-MAR-2026CE24000,CE,24000,1629.4,25424.65,1021020.0,OPTIDXNIFTY30-MAR-2026CE24000,1886.5,25713.0,986180.0,27054.050000000003,23795.25,34840.0,3.532823622462431,166.36499880000002
OPTIDXNIFTY30-MAR-2026CE24250,CE,24250,1370.35,25424.65,650.0,OPTIDXNIFTY30-MAR-2026CE24250,1642.85,25713.0,585.0,26795.0,24054.300000000003,65.0,11.11111111111111,0.08907275
OPTIDXNIFTY30-MAR-2026PE24400,PE,24400,84.85,25424.65,356005.0,OPTIDXNIFTY30-MAR-2026PE24400,71.75,25713.0,347360.0,25509.5,25339.800000000003,8645.0,2.48877245508982,3.0207024249999996
OPTIDXNIFTY30-MAR-2026CE24550,CE,24550,1134.7,25424.65,1690.0,OPTIDXNIFTY30-MAR-2026CE24550,1376.25,25713.0,1105.0,26559.350000000002,24289.95,585.0,52.94117647058824,0.1917643
OPTIDXNIFTY30-MAR-2026PE24650,PE,24650,115.8,25424.65,28600.0,OPTIDXNIFTY30-MAR-2026PE24650,90.85,25713.0,30420.0,25540.45,25308.850000000002,-1820.0,-5.982905982905983,0.331188
OPTIDXNIFTY30-MAR-2026PE24750,PE,24750,130.2,25424.65,32695.0,OPTIDXNIFTY30-MAR-2026PE24750,101.7,25713.0,32500.0,25554.850000000002,25294.45,195.0,0.6,0.4256888999999999
OPTIDXNIFTY30-MAR-2026CE25250,CE,25250,585.6,25424.65,17940.0,OPTIDXNIFTY30-MAR-2026CE25250,718.1,25713.0,17485.0,26010.25,24839.050000000003,455.0,2.6022304832713754,1.0505664
OPTIDXNIFTY30-MAR-2026PE25750,PE,25750,444.2,25424.65,86515.0,OPTIDXNIFTY30-MAR-2026PE25750,322.9,25713.0,96460.0,25868.850000000002,24980.45,-9945.0,-10.309973045822103,3.8429963
OPTIDXNIFTY30-MAR-2026PE26100,PE,26100,646.05,25424.65,259350.0,OPTIDXNIFTY30-MAR-2026PE26100,476.85,25713.0,243555.0,26070.7,24778.600000000002,15795.0,6.485188150520416,16.75530675
OPTIDXNIFTY30-MAR-2026CE26250,CE,26250,113.95,25424.65,75530.0,OPTIDXNIFTY30-MAR-2026CE26250,182.4,25713.0,64090.0,25538.600000000002,25310.7,11440.0,17.849898580121703,0.86066435
OPTIDXNIFTY30-MAR-2026CE27050,CE,27050,19.8,25424.65,34190.0,OPTIDXNIFTY30-MAR-2026CE27050,28.55,25713.0,27820.0,25444.45,25404.850000000002,6370.0,22.897196261682243,0.06769620000000001
OPTIDXNIFTY30-MAR-2026PE27750,PE,27750,2157.55,25424.65,325.0,OPTIDXNIFTY30-MAR-2026PE27750,1866.45,25713.0,325.0,27582.2,23267.100000000002,0.0,0.0,0.070120375
OPTIDXNIFTY30-MAR-2026CE27850,CE,27850,7.75,25424.65,5980.0,OPTIDXNIFTY30-MAR-2026CE27850,8.2,25713.0,5785.0,25432.4,25416.9,195.0,3.3707865168539324,0.0046345
OPTIDXNIFTY30-MAR-2026CE31000,CE,31000,2.1,25424.65,256165.0,OPTIDXNIFTY30-MAR-2026CE31000,2.55,25713.0,257855.0,25426.75,25422.550000000003,-1690.0,-0.6554071086463322,0.05379465
OPTIDXNIFTY30-MAR-2026PE23200,PE,23200,27.5,25424.65,61360.0,OPTIDXNIFTY30-MAR-2026PE23200,28.25,25713.0,46735.0,25452.15,25397.15,14625.0,31.29346314325452,0.16874
OPTIDXNIFTY30-MAR-2026CE23250,CE,23250,2335.0,25424.65,130.0,OPTIDXNIFTY30-MAR-2026CE23250,,25713.0,65.0,27759.65,23089.65,65.0,100.0,0.030355
OPTIDXNIFTY30-MAR-2026CE23450,CE,23450,2222.0,25424.65,195.0,OPTIDXNIFTY30-MAR-2026CE23450,2390.4,25713.0,260.0,27646.65,23202.65,-65.0,-25.0,0.043329
OPTIDXNIFTY30-MAR-2026CE23700,CE,23700,1881.05,25424.65,2145.0,OPTIDXNIFTY30-MAR-2026CE23700,2184.1,25713.0,1690.0,27305.7,23543.600000000002,455.0,26.923076923076923,0.403485225
OPTIDXNIFTY30-MAR-2026PE23800,PE,23800,43.8,25424.65,524225.0,OPTIDXNIFTY30-MAR-2026PE23800,43.3,25713.0,502320.0,25468.45,25380.850000000002,21905.0,4.3607660455486545,2.2961055
OPTIDXNIFTY30-MAR-2026PE23850,PE,23850,47.2,25424.65,17810.0,OPTIDXNIFTY30-MAR-2026PE23850,45.4,25713.0,21190.0,25471.850000000002,25377.45,-3380.0,-15.950920245398773,0.08406320000000002
OPTIDXNIFTY30-MAR-2026CE24200,CE,24200,1449.2,25424.65,7670.0,OPTIDXNIFTY30-MAR-2026CE24200,1695.0,25713.0,6500.0,26873.850000000002,23975.45,1170.0,18.0,1.1115364
OPTIDXNIFTY30-MAR-2026CE24600,CE,24600,1097.95,25424.65,16770.0,OPTIDXNIFTY30-MAR-2026CE24600,1330.1,25713.0,16965.0,26522.600000000002,24326.7,-195.0,-1.1494252873563218,1.8412621500000004
OPTIDXNIFTY30-MAR-2026PE25050,PE,25050,187.65,25424.65,56680.0,OPTIDXNIFTY30-MAR-2026PE25050,141.85,25713.0,52585.0,25612.300000000003,25237.0,4095.0,7.787391841779975,1.0636002000000002
OPTIDXNIFTY30-MAR-2026PE25300,PE,25300,259.35,25424.65,722280.0,OPTIDXNIFTY30-MAR-2026PE25300,189.0,25713.0,704340.0,25684.0,25165.300000000003,17940.0,2.547065337763012,18.7323318
OPTIDXNIFTY30-MAR-2026CE25400,CE,25400,491.4,25424.65,393055.0,OPTIDXNIFTY30-MAR-2026CE25400,673.45,25713.0,195520.0,25916.050000000003,24933.25,197535.0,101.03058510638299,19.3147227
OPTIDXNIFTY30-MAR-2026PE26000,PE,26000,588.75,25424.65,4790695.0,OPTIDXNIFTY30-MAR-2026PE26000,431.55,25713.0,4648215.0,26013.4,24835.9,142480.0,3.065262686859364,282.052168125
OPTIDXNIFTY30-MAR-2026CE26100,CE,26100,154.55,25424.65,554190.0,OPTIDXNIFTY30-MAR-2026CE26100,244.05,25713.0,412555.0,25579.2,25270.100000000002,141635.0,34.331180085079566,8.56500645
OPTIDXNIFTY30-MAR-2026CE27150,CE,27150,16.65,25424.65,24700.0,OPTIDXNIFTY30-MAR-2026CE27150,23.05,25713.0,19305.0,25441.300000000003,25408.0,5395.0,27.946127946127948,0.041125499999999995
OPTIDXNIFTY30-MAR-2026PE27200,PE,27200,1612.1,25424.65,23400.0,OPTIDXNIFTY30-MAR-2026PE27200,1338.1,25713.0,22945.0,27036.75,23812.550000000003,455.0,1.9830028328611897,3.772314
OPTIDXNIFTY30-MAR-2026CE27450,CE,27450,11.25,25424.65,22100.0,OPTIDXNIFTY30-MAR-2026CE27450,13.65,25713.0,22685.0,25435.9,25413.4,-585.0,-2.5787965616045847,0.0248625
OPTIDXNIFTY30-MAR-2026PE20000,PE,20000,7.6,25424.65,689065.0,OPTIDXNIFTY30-MAR-2026PE20000,8.45,25713.0,695240.0,25432.25,25417.050000000003,-6175.0,-0.888182498130142,0.5236893999999999
OPTIDXNIFTY30-MAR-2026CE23000,CE,23000,2592.9,25424.65,820170.0,OPTIDXNIFTY30-MAR-2026CE23000,2845.85,25713.0,808925.0,28017.550000000003,22831.75,11245.0,1.390116512655685,212.66187930000004
OPTIDXNIFTY30-MAR-2026CE23350,CE,23350,2238.45,25424.65,130.0,OPTIDXNIFTY30-MAR-2026CE23350,,25713.0,65.0,27663.100000000002,23186.2,65.0,100.0,0.02909985
OPTIDXNIFTY30-MAR-2026PE23450,PE,23450,33.25,25424.65,8255.0,OPTIDXNIFTY30-MAR-2026PE23450,33.55,25713.0,9100.0,25457.9,25391.4,-845.0,-9.285714285714286,0.027447875
OPTIDXNIFTY30-MAR-2026PE23700,PE,23700,41.4,25424.65,406900.0,OPTIDXNIFTY30-MAR-2026PE23700,41.25,25713.0,406250.0,25466.050000000003,25383.25,650.0,0.16,1.684566
OPTIDXNIFTY30-MAR-2026PE24150,PE,24150,63.95,25424.65,22490.0,OPTIDXNIFTY30-MAR-2026PE24150,57.55,25713.0,23660.0,25488.600000000002,25360.7,-1170.0,-4.945054945054945,0.14382355
OPTIDXNIFTY30-MAR-2026CE24750,CE,24750,959.7,25424.65,1950.0,OPTIDXNIFTY30-MAR-2026CE24750,1175.9,25713.0,1690.0,26384.350000000002,24464.95,260.0,15.384615384615385,0.1871415
OPTIDXNIFTY30-MAR-2026CE24950,CE,24950,794.85,25424.65,2015.0,OPTIDXNIFTY30-MAR-2026CE24950,1034.35,25713.0,1560.0,26219.5,24629.800000000003,455.0,29.166666666666668,0.16016227500000002
OPTIDXNIFTY30-MAR-2026PE25550,PE,25550,347.3,25424.65,67145.0,OPTIDXNIFTY30-MAR-2026PE25550,255.65,25713.0,53625.0,25771.95,25077.350000000002,13520.0,25.212121212121215,2.33194585
OPTIDXNIFTY30-MAR-2026PE25650,PE,25650,392.45,25424.65,66560.0,OPTIDXNIFTY30-MAR-2026PE25650,287.65,25713.0,93470.0,25817.100000000002,25032.2,-26910.0,-28.789986091794155,2.6121472
OPTIDXNIFTY30-MAR-2026CE26400,CE,26400,81.95,25424.65,777660.0,OPTIDXNIFTY30-MAR-2026CE26400,131.75,25713.0,627640.0,25506.600000000002,25342.7,150020.0,23.902236951118475,6.3729237
OPTIDXNIFTY30-MAR-2026CE26600,CE,26600,52.1,25424.65,551720.0,OPTIDXNIFTY30-MAR-2026CE26600,83.95,25713.0,557050.0,25476.75,25372.550000000003,-5330.0,-0.956826137689615,2.8744612
OPTIDXNIFTY30-MAR-2026PE26650,PE,26650,1167.65,25424.65,2405.0,OPTIDXNIFTY30-MAR-2026PE26650,877.45,25713.0,2470.0,26592.300000000003,24257.0,-65.0,-2.631578947368421,0.280819825
OPTIDXNIFTY30-MAR-2026CE26700,CE,26700,41.55,25424.65,614640.0,OPTIDXNIFTY30-MAR-2026CE26700,65.55,25713.0,580385.0,25466.2,25383.100000000002,34255.0,5.902116698398477,2.5538292
OPTIDXNIFTY30-MAR-2026PE26750,PE,26750,1221.3,25424.65,2210.0,OPTIDXNIFTY30-MAR-2026PE26750,1007.7,25713.0,2340.0,26645.95,24203.350000000002,-130.0,-5.555555555555555,0.2699073
OPTIDXNIFTY30-MAR-2026PE26850,PE,26850,1311.6,25424.65,975.0,OPTIDXNIFTY30-MAR-2026PE26850,1038.25,25713.0,975.0,26736.25,24113.050000000003,0.0,0.0,0.127881
OPTIDXNIFTY30-MAR-2026CE27000,CE,27000,22.55,25424.65,3997370.0,OPTIDXNIFTY30-MAR-2026CE27000,32.2,25713.0,3859310.0,25447.2,25402.100000000002,138060.0,3.577323407552127,9.014069350000002
OPTIDXNIFTY30-MAR-2026CE27400,CE,27400,11.05,25424.65,295750.0,OPTIDXNIFTY30-MAR-2026CE27400,14.0,25713.0,306345.0,25435.7,25413.600000000002,-10595.0,-3.4585189900275837,0.32680375
OPTIDXNIFTY30-MAR-2026PE27400,PE,27400,1811.0,25424.65,7995.0,OPTIDXNIFTY30-MAR-2026PE27400,1531.05,25713.0,6955.0,27235.65,23613.65,1040.0,14.953271028037381,1.4478945
OPTIDXNIFTY30-MAR-2026CE27500,CE,27500,10.1,25424.65,1167270.0,OPTIDXNIFTY30-MAR-2026CE27500,12.35,25713.0,1083485.0,25434.75,25414.550000000003,83785.0,7.732917391565181,1.1789427
OPTIDXNIFTY30-MAR-2026CE27550,CE,27550,10.05,25424.65,22490.0,OPTIDXNIFTY30-MAR-2026CE27550,12.2,25713.0,21970.0,25434.7,25414.600000000002,520.0,2.366863905325444,0.02260245
OPTIDXNIFTY30-MAR-2026CE27900,CE,27900,7.1,25424.65,65455.0,OPTIDXNIFTY30-MAR-2026CE27900,8.45,25713.0,15795.0,25431.75,25417.550000000003,49660.0,314.40329218106996,0.04647305
OPTIDXNIFTY30-MAR-2026PE27900,PE,27900,2292.45,25424.65,3250.0,OPTIDXNIFTY30-MAR-2026PE27900,2086.25,25713.0,3055.0,27717.100000000002,23132.2,195.0,6.382978723404255,0.7450462499999999
OPTIDXNIFTY30-MAR-2026CE27950,CE,27950,7.5,25424.65,11960.0,OPTIDXNIFTY30-MAR-2026CE27950,7.95,25713.0,11700.0,25432.15,25417.15,260.0,2.2222222222222223,0.00897
OPTIDXNIFTY30-MAR-2026CE29000,CE,29000,3.65,25424.65,765245.0,OPTIDXNIFTY30-MAR-2026CE29000,4.15,25713.0,797420.0,25428.300000000003,25421.0,-32175.0,-4.034887512226932,0.279314425
OPTIDXNIFTY30-MAR-2026PE27850,PE,27850,,25424.65,390.0,OPTIDXNIFTY30-MAR-2026PE27850,1983.55,25713.0,390.0,25424.65,25424.65,0.0,0.0,0.0
OPTIDXNIFTY30-MAR-2026CE27750,CE,27750,7.7,25424.65,10400.0,OPTIDXNIFTY30-MAR-2026CE27750,9.45,25713.0,7605.0,25432.350000000002,25416.95,2795.0,36.75213675213676,0.008008
OPTIDXNIFTY30-MAR-2026PE27550,PE,27550,1960.7,25424.65,520.0,OPTIDXNIFTY30-MAR-2026PE27550,1690.05,25713.0,390.0,27385.350000000002,23463.95,130.0,33.33333333333333,0.1019564
OPTIDXNIFTY30-MAR-2026PE27450,PE,27450,1861.8,25424.65,390.0,OPTIDXNIFTY30-MAR-2026PE27450,1590.45,25713.0,390.0,27286.45,23562.850000000002,0.0,0.0,0.0726102
OPTIDXNIFTY30-MAR-2026CE27350,CE,27350,12.55,25424.65,19175.0,OPTIDXNIFTY30-MAR-2026CE27350,16.05,25713.0,19630.0,25437.2,25412.100000000002,-455.0,-2.3178807947019866,0.024064625
OPTIDXNIFTY30-MAR-2026CE27100,CE,27100,18.0,25424.65,304460.0,OPTIDXNIFTY30-MAR-2026CE27100,25.3,25713.0,246740.0,25442.65,25406.65,57720.0,23.39304531085353,0.548028
OPTIDXNIFTY30-MAR-2026CE26900,CE,26900,26.85,25424.65,296725.0,OPTIDXNIFTY30-MAR-2026CE26900,40.0,25713.0,315770.0,25451.5,25397.800000000003,-19045.0,-6.031288596130095,0.796706625
OPTIDXNIFTY30-MAR-2026PE26550,PE,26550,1028.0,25424.65,2795.0,OPTIDXNIFTY30-MAR-2026PE26550,770.0,25713.0,3120.0,26452.65,24396.65,-325.0,-10.416666666666668,0.287326
OPTIDXNIFTY30-MAR-2026PE26350,PE,26350,835.35,25424.65,12935.0,OPTIDXNIFTY30-MAR-2026PE26350,630.95,25713.0,14235.0,26260.0,24589.300000000003,-1300.0,-9.1324200913242,1.080525225
OPTIDXNIFTY30-MAR-2026CE26200,CE,26200,125.45,25424.65,1039935.0,OPTIDXNIFTY30-MAR-2026CE26200,201.65,25713.0,814255.0,25550.100000000002,25299.2,225680.0,27.71613315239084,13.045984575
OPTIDXNIFTY30-MAR-2026PE26050,PE,26050,614.1,25424.65,22360.0,OPTIDXNIFTY30-MAR-2026PE26050,458.15,25713.0,22100.0,26038.75,24810.550000000003,260.0,1.1764705882352942,1.3731276
OPTIDXNIFTY30-MAR-2026CE25900,CE,25900,227.6,25424.65,609830.0,OPTIDXNIFTY30-MAR-2026CE25900,346.05,25713.0,449020.0,25652.25,25197.050000000003,160810.0,35.81354950781702,13.879730799999997
OPTIDXNIFTY30-MAR-2026CE25800,CE,25800,272.65,25424.65,1254175.0,OPTIDXNIFTY30-MAR-2026CE25800,404.8,25713.0,922675.0,25697.300000000003,25152.0,331500.0,35.92814371257485,34.195081375
OPTIDXNIFTY30-MAR-2026PE25400,PE,25400,295.1,25424.65,943605.0,OPTIDXNIFTY30-MAR-2026PE25400,212.9,25713.0,751595.0,25719.75,25129.550000000003,192010.0,25.54700337282712,27.84578355
OPTIDXNIFTY30-MAR-2026PE25250,PE,25250,241.0,25424.65,79365.0,OPTIDXNIFTY30-MAR-2026PE25250,178.4,25713.0,47190.0,25665.65,25183.65,32175.0,68.18181818181817,1.9126965
OPTIDXNIFTY30-MAR-2026CE25000,CE,25000,769.0,25424.65,1086085.0,OPTIDXNIFTY30-MAR-2026CE25000,986.35,25713.0,936130.0,26193.65,24655.65,149955.0,16.01860852659353,83.5199365
OPTIDXNIFTY30-MAR-2026PE24800,PE,24800,138.4,25424.65,668395.0,OPTIDXNIFTY30-MAR-2026PE24800,107.45,25713.0,577200.0,25563.050000000003,25286.25,91195.0,15.79954954954955,9.2505868
OPTIDXNIFTY30-MAR-2026PE24700,PE,24700,122.4,25424.65,421200.0,OPTIDXNIFTY30-MAR-2026PE24700,96.75,25713.0,420745.0,25547.050000000003,25302.25,455.0,0.10814151089139502,5.155488
OPTIDXNIFTY30-MAR-2026PE24600,PE,24600,108.25,25424.65,487435.0,OPTIDXNIFTY30-MAR-2026PE24600,86.8,25713.0,402025.0,25532.9,25316.4,85410.0,21.244947453516573,5.276483875
OPTIDXNIFTY30-MAR-2026PE24450,PE,24450,90.15,25424.65,17940.0,OPTIDXNIFTY30-MAR-2026PE24450,75.9,25713.0,20215.0,25514.800000000003,25334.5,-2275.0,-11.254019292604502,0.1617291
OPTIDXNIFTY30-MAR-2026PE24050,PE,24050,57.25,25424.65,21970.0,OPTIDXNIFTY30-MAR-2026PE24050,53.25,25713.0,29120.0,25481.9,25367.4,-7150.0,-24.553571428571427,0.12577825
OPTIDXNIFTY30-MAR-2026CE23400,CE,23400,2169.5,25424.65,1040.0,OPTIDXNIFTY30-MAR-2026CE23400,2450.8,25713.0,975.0,27594.15,23255.15,65.0,6.666666666666667,0.225628
OPTIDXNIFTY30-MAR-2026CE23150,CE,23150,2433.3,25424.65,130.0,OPTIDXNIFTY30-MAR-2026CE23150,,25713.0,65.0,27857.95,22991.350000000002,65.0,100.0,0.0316329
OPTIDXNIFTY30-MAR-2026PE22000,PE,22000,12.15,25424.65,1392300.0,OPTIDXNIFTY30-MAR-2026PE22000,14.35,25713.0,1347125.0,25436.800000000003,25412.5,45175.0,3.353437876960193,1.6916445
OPTIDXNIFTY30-MAR-2026PE19000,PE,19000,5.5,25424.65,399165.0,OPTIDXNIFTY30-MAR-2026PE19000,6.0,25713.0,342225.0,25430.15,25419.15,56940.0,16.63817663817664,0.21954075
OPTIDXNIFTY30-MAR-2026PE23350,PE,23350,30.5,25424.65,12285.0,OPTIDXNIFTY30-MAR-2026PE23350,32.0,25713.0,11765.0,25455.15,25394.15,520.0,4.41988950276243,0.03746925
OPTIDXNIFTY30-MAR-2026CE23500,CE,23500,2098.8,25424.65,281580.0,OPTIDXNIFTY30-MAR-2026CE23500,2361.0,25713.0,161460.0,27523.45,23325.850000000002,120120.0,74.39613526570048,59.098010400000014
OPTIDXNIFTY30-MAR-2026PE23500,PE,23500,33.4,25424.65,1250665.0,OPTIDXNIFTY30-MAR-2026PE23500,34.85,25713.0,1085045.0,25458.050000000003,25391.25,165620.0,15.263883064757684,4.1772211
OPTIDXNIFTY30-MAR-2026PE24350,PE,24350,79.45,25424.65,17355.0,OPTIDXNIFTY30-MAR-2026PE24350,67.2,25713.0,20085.0,25504.100000000002,25345.2,-2730.0,-13.592233009708737,0.137885475
OPTIDXNIFTY30-MAR-2026CE24900,CE,24900,842.65,25424.65,18200.0,OPTIDXNIFTY30-MAR-2026CE24900,1080.0,25713.0,14040.0,26267.300000000003,24582.0,4160.0,29.629629629629626,1.533623
OPTIDXNIFTY30-MAR-2026PE25000,PE,25000,178.15,25424.65,6035770.0,OPTIDXNIFTY30-MAR-2026PE25000,134.4,25713.0,6056960.0,25602.800000000003,25246.5,-21190.0,-0.34984546703296704,107.52724255
OPTIDXNIFTY30-MAR-2026CE25150,CE,25150,652.05,25424.65,19045.0,OPTIDXNIFTY30-MAR-2026CE25150,855.5,25713.0,18330.0,26076.7,24772.600000000002,715.0,3.900709219858156,1.241829225
OPTIDXNIFTY30-MAR-2026PE25350,PE,25350,275.6,25424.65,62140.0,OPTIDXNIFTY30-MAR-2026PE25350,201.65,25713.0,38805.0,25700.25,25149.050000000003,23335.0,60.13400335008375,1.7125784000000004
OPTIDXNIFTY30-MAR-2026CE25500,CE,25500,427.3,25424.65,2542995.0,OPTIDXNIFTY30-MAR-2026CE25500,599.85,25713.0,1719315.0,25851.95,24997.350000000002,823680.0,47.907451514120446,108.66217635
OPTIDXNIFTY30-MAR-2026PE25500,PE,25500,329.9,25424.65,3452475.0,OPTIDXNIFTY30-MAR-2026PE25500,241.0,25713.0,3518255.0,25754.550000000003,25094.75,-65780.0,-1.8696768710625014,113.89715025
OPTIDXNIFTY30-MAR-2026CE25750,CE,25750,293.15,25424.65,100360.0,OPTIDXNIFTY30-MAR-2026CE25750,431.7,25713.0,67795.0,25717.800000000003,25131.5,32565.0,48.034515819750716,2.9420534
OPTIDXNIFTY30-MAR-2026CE26050,CE,26050,171.9,25424.65,91000.0,OPTIDXNIFTY30-MAR-2026CE26050,267.75,25713.0,67860.0,25596.550000000003,25252.75,23140.0,34.099616858237546,1.56429
OPTIDXNIFTY30-MAR-2026CE26150,CE,26150,139.8,25424.65,50245.0,OPTIDXNIFTY30-MAR-2026CE26150,222.85,25713.0,31265.0,25564.45,25284.850000000002,18980.0,60.70686070686071,0.7024251000000001
OPTIDXNIFTY30-MAR-2026PE26300,PE,26300,799.4,25424.65,212810.0,OPTIDXNIFTY30-MAR-2026PE26300,589.7,25713.0,199615.0,26224.050000000003,24625.25,13195.0,6.610224682513839,17.0120314
OPTIDXNIFTY30-MAR-2026PE27250,PE,27250,1668.55,25424.65,520.0,OPTIDXNIFTY30-MAR-2026PE27250,1382.25,25713.0,520.0,27093.2,23756.100000000002,0.0,0.0,0.0867646
OPTIDXNIFTY30-MAR-2026PE27650,PE,27650,,25424.65,1365.0,OPTIDXNIFTY30-MAR-2026PE27650,1774.9,25713.0,1365.0,25424.65,25424.65,0.0,0.0,0.0
OPTIDXNIFTY30-MAR-2026CE28000,CE,28000,6.65,25424.65,1829815.0,OPTIDXNIFTY30-MAR-2026CE28000,7.15,25713.0,1772355.0,25431.300000000003,25418.0,57460.0,3.2420141563061575,1.2168269750000003
OPTIDXNIFTY30-MAR-2026PE28050,PE,28050,,25424.65,260.0,OPTIDXNIFTY30-MAR-2026PE28050,,25713.0,260.0,25424.65,25424.65,0.0,0.0,0.0
OPTIDXNIFTY30-MAR-2026CE21000,CE,21000,4561.6,25424.65,376610.0,OPTIDXNIFTY30-MAR-2026CE21000,4829.15,25713.0,376610.0,29986.25,20863.050000000003,0.0,0.0,171.79441760000003
OPTIDXNIFTY30-MAR-2026CE23550,CE,23550,2045.9,25424.65,260.0,OPTIDXNIFTY30-MAR-2026CE23550,,25713.0,195.0,27470.550000000003,23378.75,65.0,33.33333333333333,0.0531934
OPTIDXNIFTY30-MAR-2026CE23600,CE,23600,1968.1,25424.65,650.0,OPTIDXNIFTY30-MAR-2026CE23600,2252.3,25713.0,585.0,27392.75,23456.550000000003,65.0,11.11111111111111,0.1279265
OPTIDXNIFTY30-MAR-2026CE23850,CE,23850,1760.7,25424.65,130.0,OPTIDXNIFTY30-MAR-2026CE23850,,25713.0,130.0,27185.350000000002,23663.95,0.0,0.0,0.0228891
OPTIDXNIFTY30-MAR-2026PE23900,PE,23900,49.35,25424.65,353665.0,OPTIDXNIFTY30-MAR-2026PE23900,47.05,25713.0,352690.0,25474.0,25375.300000000003,975.0,0.27644673792849245,1.7453367750000004
OPTIDXNIFTY30-MAR-2026CE23950,CE,23950,1662.25,25424.65,195.0,OPTIDXNIFTY30-MAR-2026CE23950,,25713.0,195.0,27086.9,23762.4,0.0,0.0,0.032413875
OPTIDXNIFTY30-MAR-2026PE24250,PE,24250,71.4,25424.65,15145.0,OPTIDXNIFTY30-MAR-2026PE24250,62.9,25713.0,18655.0,25496.050000000003,25353.25,-3510.0,-18.81533101045296,0.1081353
OPTIDXNIFTY30-MAR-2026CE25450,CE,25450,460.2,25424.65,54795.0,OPTIDXNIFTY30-MAR-2026CE25450,634.65,25713.0,28925.0,25884.850000000002,24964.45,25870.0,89.43820224719101,2.5216659
OPTIDXNIFTY30-MAR-2026PE25450,PE,25450,310.6,25424.65,73645.0,OPTIDXNIFTY30-MAR-2026PE25450,227.55,25713.0,55315.0,25735.25,25114.050000000003,18330.0,33.13748531139836,2.2874137000000005
OPTIDXNIFTY30-MAR-2026PE25800,PE,25800,470.25,25424.65,1567540.0,OPTIDXNIFTY30-MAR-2026PE25800,341.95,25713.0,1119625.0,25894.9,24954.4,447915.0,40.00580551523948,73.7135685
OPTIDXNIFTY30-MAR-2026CE25950,CE,25950,206.9,25424.65,70135.0,OPTIDXNIFTY30-MAR-2026CE25950,319.2,25713.0,50635.0,25631.550000000003,25217.75,19500.0,38.51091142490372,1.45109315
OPTIDXNIFTY30-MAR-2026PE26150,PE,26150,684.0,25424.65,28925.0,OPTIDXNIFTY30-MAR-2026PE26150,519.25,25713.0,23985.0,26108.65,24740.65,4940.0,20.59620596205962,1.97847
OPTIDXNIFTY30-MAR-2026CE26750,CE,26750,37.5,25424.65,42640.0,OPTIDXNIFTY30-MAR-2026CE26750,58.35,25713.0,46865.0,25462.15,25387.15,-4225.0,-9.015256588072122,0.1599
OPTIDXNIFTY30-MAR-2026PE26900,PE,26900,1330.0,25424.65,6760.0,OPTIDXNIFTY30-MAR-2026PE26900,1068.5,25713.0,6045.0,26754.65,24094.65,715.0,11.827956989247312,0.89908
OPTIDXNIFTY30-MAR-2026CE26950,CE,26950,24.35,25424.65,46150.0,OPTIDXNIFTY30-MAR-2026CE26950,35.7,25713.0,36790.0,25449.0,25400.300000000003,9360.0,25.4416961130742,0.11237525
OPTIDXNIFTY30-MAR-2026CE27300,CE,27300,13.35,25424.65,461045.0,OPTIDXNIFTY30-MAR-2026CE27300,17.0,25713.0,455585.0,25438.0,25411.300000000003,5460.0,1.19845912398345,0.615495075
OPTIDXNIFTY30-MAR-2026PE29000,PE,29000,3368.8,25424.65,447720.0,OPTIDXNIFTY30-MAR-2026PE29000,3107.6,25713.0,441610.0,28793.45,22055.850000000002,6110.0,1.38357374153665,150.82791360000002
OPTIDXNIFTY30-MAR-2026PE31000,PE,31000,5350.0,25424.65,203710.0,OPTIDXNIFTY30-MAR-2026PE31000,5140.45,25713.0,206245.0,30774.65,20074.65,-2535.0,-1.2291207059565081,108.98485
OPTIDXNIFTY30-MAR-2026CE19000,CE,19000,6521.9,25424.65,180960.0,OPTIDXNIFTY30-MAR-2026CE19000,6764.3,25713.0,178555.0,31946.550000000003,18902.75,2405.0,1.346923917000364,118.02030239999998
OPTIDXNIFTY30-MAR-2026CE22000,CE,22000,3559.2,25424.65,389155.0,OPTIDXNIFTY30-MAR-2026CE22000,3821.6,25713.0,389025.0,28983.850000000002,21865.45,130.0,0.03341687552213868,138.5080476
OPTIDXNIFTY30-MAR-2026PE23000,PE,23000,22.75,25424.65,2696850.0,OPTIDXNIFTY30-MAR-2026PE23000,24.05,25713.0,2398565.0,25447.4,25401.9,298285.0,12.435977344787403,6.13533375
OPTIDXNIFTY30-MAR-2026CE23100,CE,23100,2490.0,25424.65,2080.0,OPTIDXNIFTY30-MAR-2026CE23100,2675.0,25713.0,1755.0,27914.65,22934.65,325.0,18.51851851851852,0.51792
OPTIDXNIFTY30-MAR-2026PE23100,PE,23100,24.25,25424.65,74620.0,OPTIDXNIFTY30-MAR-2026PE23100,26.95,25713.0,29185.0,25448.9,25400.4,45435.0,155.6792873051225,0.1809535
OPTIDXNIFTY30-MAR-2026CE23300,CE,23300,2256.2,25424.65,325.0,OPTIDXNIFTY30-MAR-2026CE23300,2571.5,25713.0,260.0,27680.850000000002,23168.45,65.0,25.0,0.0733265
OPTIDXNIFTY30-MAR-2026CE23650,CE,23650,1950.15,25424.65,195.0,OPTIDXNIFTY30-MAR-2026CE23650,,25713.0,130.0,27374.800000000003,23474.5,65.0,50.0,0.038027925000000004
OPTIDXNIFTY30-MAR-2026CE23750,CE,23750,1848.1,25424.65,9360.0,OPTIDXNIFTY30-MAR-2026CE23750,2158.7,25713.0,9360.0,27272.75,23576.550000000003,0.0,0.0,1.7298215999999997
OPTIDXNIFTY30-MAR-2026PE23950,PE,23950,51.9,25424.65,28925.0,OPTIDXNIFTY30-MAR-2026PE23950,48.9,25713.0,22555.0,25476.550000000003,25372.75,6370.0,28.24207492795389,0.15012075
OPTIDXNIFTY30-MAR-2026PE24950,PE,24950,163.85,25424.65,45500.0,OPTIDXNIFTY30-MAR-2026PE24950,126.85,25713.0,40170.0,25588.5,25260.800000000003,5330.0,13.268608414239482,0.7455175
OPTIDXNIFTY30-MAR-2026CE25350,CE,25350,520.9,25424.65,33020.0,OPTIDXNIFTY30-MAR-2026CE25350,712.4,25713.0,15535.0,25945.550000000003,24903.75,17485.0,112.55230125523012,1.7200118
OPTIDXNIFTY30-MAR-2026PE25950,PE,25950,557.95,25424.65,21710.0,OPTIDXNIFTY30-MAR-2026PE25950,406.7,25713.0,19305.0,25982.600000000002,24866.7,2405.0,12.457912457912458,1.2113094500000001
OPTIDXNIFTY30-MAR-2026PE26250,PE,26250,750.45,25424.65,17485.0,OPTIDXNIFTY30-MAR-2026PE26250,566.15,25713.0,16965.0,26175.100000000002,24674.2,520.0,3.065134099616858,1.3121618250000002
OPTIDXNIFTY30-MAR-2026PE26450,PE,26450,847.35,25424.65,6500.0,OPTIDXNIFTY30-MAR-2026PE26450,723.2,25713.0,7345.0,26272.0,24577.300000000003,-845.0,-11.504424778761061,0.5507775
OPTIDXNIFTY30-MAR-2026PE26800,PE,26800,1216.4,25424.65,44980.0,OPTIDXNIFTY30-MAR-2026PE26800,979.9,25713.0,40690.0,26641.050000000003,24208.25,4290.0,10.543130990415335,5.4713672
OPTIDXNIFTY30-MAR-2026CE26850,CE,26850,30.3,25424.65,47515.0,OPTIDXNIFTY30-MAR-2026CE26850,45.75,25713.0,47645.0,25454.95,25394.350000000002,-130.0,-0.2728512960436562,0.14397045
OPTIDXNIFTY30-MAR-2026PE27100,PE,27100,1500.3,25424.65,3900.0,OPTIDXNIFTY30-MAR-2026PE27100,1234.4,25713.0,3900.0,26924.95,23924.350000000002,0.0,0.0,0.585117
OPTIDXNIFTY30-MAR-2026PE27500,PE,27500,1888.2,25424.65,431990.0,OPTIDXNIFTY30-MAR-2026PE27500,1632.9,25713.0,370695.0,27312.850000000002,23536.45,61295.0,16.535156934946517,81.56835180000002
OPTIDXNIFTY30-MAR-2026CE27600,CE,27600,8.75,25424.65,118885.0,OPTIDXNIFTY30-MAR-2026CE27600,10.85,25713.0,110890.0,25433.4,25415.9,7995.0,7.209847596717468,0.104024375
OPTIDXNIFTY30-MAR-2026PE28000,PE,28000,2381.8,25424.65,942630.0,OPTIDXNIFTY30-MAR-2026PE28000,2121.45,25713.0,894985.0,27806.45,23042.850000000002,47645.0,5.323552908707967,224.5156134
OPTIDXNIFTY30-MAR-2026CE28050,CE,28050,6.95,25424.65,6890.0,OPTIDXNIFTY30-MAR-2026CE28050,6.95,25713.0,6890.0,25431.600000000002,25417.7,0.0,0.0,0.00478855`;

let headers = [];
let originalData = [];
let filteredData = [];
let displayData = [];
let sortColumn = null;
let sortDirection = 'asc';
let currentPage = 1;
let rowsPerPage = 200;
let columnFilters = {};
let hiddenColumns = new Set();

const numericColumns = ['STRIKE_PR', 'CLOSE_PRIC', 'UNDRLNG_ST', 'OI_NO_CON', 'CLOSE_PRIC_prev', 
                        'UNDRLNG_ST_prev', 'OI_NO_CON_prev', 'Range1', 'Range2', 'OI_CHANGE', 
                        'CHG_IN_OI', 'NOTIONAL_VALUE'];

parseCSV(CSV_TEXT);

function parseCSV(text) {
    const rows = text.trim().split("\n").map(r => r.split(","));
    headers = rows[0];
    originalData = rows.slice(1).map(r => {
        let obj = {};
        headers.forEach((h, i) => { obj[h] = r[i] || ''; });
        return obj;
    });
    filteredData = [...originalData];
    displayData = [...originalData];
    updateStats();
    renderTable();
    renderPagination();
}

function renderTable() {
    renderHeaders();
    renderBody();
}

function renderHeaders() {
    let html = '<tr>';
    headers.forEach(h => {
        if (hiddenColumns.has(h)) return;
        const sortClass = sortColumn === h ? `sorted-${sortDirection}` : '';
        html += `<th class="${sortClass}" onclick="sortByColumn('${h}')">
                    <div>${h}</div>
                    <input type="text" class="filter-input" placeholder="Filter..." 
                           onclick="event.stopPropagation()" oninput="filterColumn('${h}', this.value)">
                 </th>`;
    });
    html += '</tr>';
    document.getElementById('table-head').innerHTML = html;
}

function renderBody() {
    const start = (currentPage - 1) * rowsPerPage;
    const end = rowsPerPage === -1 ? displayData.length : start + rowsPerPage;
    const pageData = displayData.slice(start, end);
    
    let html = '';
    pageData.forEach(row => {
        html += '<tr>';
        headers.forEach(h => {
            if (hiddenColumns.has(h)) return;
            const value = row[h];
            const isNumeric = numericColumns.includes(h);
            let className = isNumeric ? 'numeric' : '';
            if (h === 'CHG_IN_OI' || h === 'OI_CHANGE') {
                const num = parseFloat(value);
                if (num > 0) className += ' positive';
                else if (num < 0) className += ' negative';
            }
            html += `<td class="${className}">${formatValue(h, value)}</td>`;
        });
        html += '</tr>';
    });
    
    document.getElementById('table-body').innerHTML = html || '<tr><td colspan="100" style="text-align:center;padding:40px;">No data to display</td></tr>';
    updatePaginationInfo();
}

function formatValue(header, value) {
    if (!value) return '-';
    if (numericColumns.includes(header)) {
        const num = parseFloat(value);
        if (isNaN(num)) return value;
        if (Math.abs(num) >= 1000000) return (num / 1000000).toFixed(2) + 'M';
        else if (Math.abs(num) >= 1000) return (num / 1000).toFixed(2) + 'K';
        else return num.toFixed(2);
    }
    return value;
}

function sortByColumn(column) {
    if (sortColumn === column) {
        sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
    } else {
        sortColumn = column;
        sortDirection = 'asc';
    }
    displayData.sort((a, b) => {
        let aVal = a[column];
        let bVal = b[column];
        if (!aVal) return 1;
        if (!bVal) return -1;
        if (numericColumns.includes(column)) {
            aVal = parseFloat(aVal) || 0;
            bVal = parseFloat(bVal) || 0;
        }
        if (sortDirection === 'asc') {
            return aVal > bVal ? 1 : -1;
        } else {
            return aVal < bVal ? 1 : -1;
        }
    });
    renderTable();
}

function filterColumn(column, value) {
    columnFilters[column] = value.toLowerCase();
    applyFilters();
}

function applyFilters() {
    filteredData = originalData.filter(row => {
        return Object.keys(columnFilters).every(col => {
            const filterValue = columnFilters[col];
            if (!filterValue) return true;
            const cellValue = String(row[col]).toLowerCase();
            return cellValue.includes(filterValue);
        });
    });
    const globalSearch = document.getElementById('global-search').value.toLowerCase();
    if (globalSearch) {
        filteredData = filteredData.filter(row => {
            return headers.some(h => String(row[h]).toLowerCase().includes(globalSearch));
        });
    }
    displayData = [...filteredData];
    currentPage = 1;
    updateStats();
    renderTable();
    renderPagination();
}

function clearFilters() {
    columnFilters = {};
    document.getElementById('global-search').value = '';
    document.querySelectorAll('.filter-input').forEach(input => input.value = '');
    applyFilters();
}

function updateStats() {
    document.getElementById('total-rows').textContent = originalData.length.toLocaleString();
    document.getElementById('filtered-rows').textContent = filteredData.length.toLocaleString();
}

function renderPagination() {
    const totalPages = rowsPerPage === -1 ? 1 : Math.ceil(displayData.length / rowsPerPage);
    document.getElementById('prev-btn').disabled = currentPage === 1;
    document.getElementById('next-btn').disabled = currentPage === totalPages || totalPages === 0;
    let pageNumbers = '';
    const maxButtons = 5;
    let startPage = Math.max(1, currentPage - Math.floor(maxButtons / 2));
    let endPage = Math.min(totalPages, startPage + maxButtons - 1);
    if (endPage - startPage < maxButtons - 1) {
        startPage = Math.max(1, endPage - maxButtons + 1);
    }
    for (let i = startPage; i <= endPage; i++) {
        const activeClass = i === currentPage ? 'active' : '';
        pageNumbers += `<button class="page-btn ${activeClass}" onclick="goToPage(${i})">${i}</button>`;
    }
    document.getElementById('page-numbers').innerHTML = pageNumbers;
}

function updatePaginationInfo() {
    const start = rowsPerPage === -1 ? 1 : (currentPage - 1) * rowsPerPage + 1;
    const end = rowsPerPage === -1 ? displayData.length : Math.min(currentPage * rowsPerPage, displayData.length);
    const total = displayData.length;
    document.getElementById('showing-start').textContent = total === 0 ? 0 : start;
    document.getElementById('showing-end').textContent = end;
    document.getElementById('showing-total').textContent = total;
}

function goToPage(page) {
    const totalPages = rowsPerPage === -1 ? 1 : Math.ceil(displayData.length / rowsPerPage);
    if (page >= 1 && page <= totalPages) {
        currentPage = page;
        renderBody();
        renderPagination();
        document.querySelector('.table-wrapper').scrollTop = 0;
    }
}

function changeRowsPerPage() {
    rowsPerPage = parseInt(document.getElementById('rows-per-page').value);
    currentPage = 1;
    renderBody();
    renderPagination();
}

function showColumnSelector() {
    const modal = document.getElementById('column-modal');
    const selector = document.getElementById('column-selector');
    let html = '';
    headers.forEach(h => {
        const checked = !hiddenColumns.has(h) ? 'checked' : '';
        html += `<div class="column-item">
                    <input type="checkbox" id="col-${h}" ${checked} onchange="toggleColumn('${h}', this.checked)">
                    <label for="col-${h}">${h}</label>
                 </div>`;
    });
    selector.innerHTML = html;
    modal.classList.add('active');
}

function closeColumnSelector() {
    document.getElementById('column-modal').classList.remove('active');
}

function toggleColumn(column, show) {
    if (show) {
        hiddenColumns.delete(column);
    } else {
        hiddenColumns.add(column);
    }
    renderTable();
}

function exportToCSV() {
    let csv = headers.filter(h => !hiddenColumns.has(h)).join(',') + '\n';
    displayData.forEach(row => {
        const values = headers.filter(h => !hiddenColumns.has(h)).map(h => {
            const value = row[h];
            if (value.includes(',') || value.includes('"')) {
                return '"' + value.replace(/"/g, '""') + '"';
            }
            return value;
        });
        csv += values.join(',') + '\n';
    });
    downloadFile(csv, 'export.csv', 'text/csv');
}

function exportToJSON() {
    const json = JSON.stringify(displayData, null, 2);
    downloadFile(json, 'export.json', 'application/json');
}

function downloadFile(content, filename, contentType) {
    const blob = new Blob([content], { type: contentType });
    const url = URL.createObjectURL(blob);
    const link = document.createElement('a');
    link.href = url;
    link.download = filename;
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    URL.revokeObjectURL(url);
}

let searchTimeout;
document.getElementById('global-search').addEventListener('input', function() {
    clearTimeout(searchTimeout);
    searchTimeout = setTimeout(() => { applyFilters(); }, 300);
});

document.getElementById('column-modal').addEventListener('click', function(e) {
    if (e.target === this) closeColumnSelector();
});

document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') closeColumnSelector();
    if ((e.ctrlKey || e.metaKey) && e.key === 'f') {
        e.preventDefault();
        document.getElementById('global-search').focus();
    }
});
</script>
</body>
</html>